-
    name: dmonte
    mail: ''
    subject: 'openDiameter nasd startup failed'
    hostname: 64.131.110.160
    created: '1244664673'
    body: "Hello Gong,\r\n\r\nFirst of all thanks for your posting on this subject.\r\n\r\nMy aaad started up OK after your recommended aaad side changes were implemented. However my nasd started up after implementing your nasd side changes were implemented, but it aborted. It seems to abort just after the \"Base [uri  = \"ftp://ftp.ietf.org/internet-drafts/draft-ietf-aaa-diameter-08.txt\" is reached.\r\n\r\nCurrently this ftp '08' document is non-existent, and the current version is '17', and it appears in many files throughout the libraries and applications directories.\r\n\r\n#\r\n# nasd\r\n(22530|3086636832)--- Call Management ---\r\n(22530|3086636832)     Thread Cnt: 5\r\n(22530|3086636832)--- Call Routing    ---\r\n(22530|3086636832)            NAI: isp.net\r\n(22530|3086636832)            AAA: diameter_eap\r\n(22530|3086636832)         Policy: script\r\n(22530|3086636832)         Policy: script\r\n(22530|3086636832)            NAI: isp1.net\r\n(22530|3086636832)            AAA: local_eap_auth\r\n(22530|3086636832)         Policy: script\r\n(22530|3086636832)         Policy: script\r\n(22530|3086636832)            NAI: local_nas@opendiameter.org\r\n(22530|3086636832)            AAA: local_eap_auth\r\n(22530|3086636832)         Policy: script\r\n(22530|3086636832)         Policy: ep-filter\r\n(22530|3086636832)         Policy: accouting\r\n(22530|3086636832)            NAI: user1@isp.net\r\n(22530|3086636832)            AAA: local_eap_auth\r\n(22530|3086636832)         Policy: script\r\n(22530|3086636832)         Policy: ep-filter\r\n(22530|3086636832)         Policy: accouting\r\n(22530|3086636832)   *Default Route*\r\n(22530|3086636832)            NAI: \r\n(22530|3086636832)            AAA: diameter_eap\r\n(22530|3086636832)         Policy: script\r\n(22530|3086636832)--- Access Protocol ---\r\n(22530|3086636832)    ** Protocol: eap_8021X\r\n(22530|3086636832)        Enabled: true\r\n(22530|3086636832)    ** Protocol: pana\r\n(22530|3086636832)        Enabled: true\r\n(22530|3086636832)       Cfg File: /etc/opendiameter/nas/config/nasd_pana_paa.xml\r\n(22530|3086636832)           EP S: /etc/opendiameter/nas/scripts/script_pana_paa_ep.sh\r\n(22530|3086636832)---   AAA Protocol  ---\r\n(22530|3086636832)    ** Protocol: diameter_eap\r\n(22530|3086636832)        Enabled: true\r\n(22530|3086636832)        Cfgfile: /etc/opendiameter/nas/config/nasd_diameter_eap.xml\r\n(22530|3086636832)    ** Protocol: local_eap_auth\r\n(22530|3086636832)        Enabled: true\r\n(22530|3086636832)         Secret: \r\n(22530|3086636832)       Identity: user1@isp.net\r\n(22530|3086636832)---  Access Policy  ---\r\n(22530|3086636832)  Access Policy: accounting\r\n(22530|3086636832)         Script: \r\n(22530|3086636832)  Access Policy: bridging\r\n(22530|3086636832)         Script: \r\n(22530|3086636832)  Access Policy: ep-filter\r\n(22530|3086636832)         Script: \r\n(22530|3086636832)  Access Policy: qos\r\n(22530|3086636832)         Script: \r\n(22530|3086636832)  Access Policy: script\r\n(22530|3086636832)         Script: /etc/opendiameter/nas/scripts/script_policy\r\n(22530|3086636832) Initializing Diameter-EAP AAA protocol\r\n(22530|3086636832) Starting diameter core\r\n(22530|3086636832)             Product : Open Diameter\r\n(22530|3086636832)             Version : 1\r\n(22530|3086636832)           Vendor Id : 0\r\n(22530|3086636832)    Supported Vendor : 0\r\n(22530|3086636832)    Supported Vendor : 1\r\n(22530|3086636832)    Auth Application : 1\r\n(22530|3086636832)    Auth Application : 2\r\n(22530|3086636832)    Auth Application : 2000\r\n(22530|3086636832)    Auth Application : 10000\r\n(22530|3086636832)    Acct Application : 3\r\n(22530|3086636832)    Acct Application : 4\r\n(22530|3086636832)    Acct Application : 20000\r\n(22530|3086636832)  Vendor Specific Id : (22530|3086636832)      Vendor=31,  Auth=1 \r\n(22530|3086636832)  Vendor Specific Id : (22530|3086636832)      Vendor=41,  Auth=5 \r\n(22530|3086636832)          Dictionary : /etc/opendiameter/nas/config/nasd_diameter_eap_dictionary.xml\r\n(22530|3086636832)            Identity : localnas.localdomain2.net\r\n(22530|3086636832)               Realm : localdomain2.net\r\n(22530|3086636832)          TCP Listen : 1810\r\n(22530|3086636832)         SCTP Listen : 1811\r\n(22530|3086636832)   Watch-Dog timeout : 3\r\n(22530|3086636832)            Use IPv6 : 0\r\n(22530|3086636832) Re-transmission Int : 8\r\n(22530|3086636832)    Max Re-trans Int : 3\r\n(22530|3086636832)    Recv Buffer Size : 2048\r\n(22530|3086636832) Dumping Peer Table\r\n(22530|3086636832)      Expire Time 1\r\n(22530|3086636832)                Peer : Host = localaaa.localdomain1.net, Port = 1812, TLS = 0\r\n(22530|3086636832)  Dumping Route Table\r\n(22530|3086636832)            Exp Time : 0\r\n(22530|3086636832)              Route  : Realm = isp.net, Action = 1, Redirect-Usage = 0\r\n(22530|3086636832)                       Application Id=1, Vendor=0\r\n(22530|3086636832)                          Server = server.isp.net, metric = 2\r\n(22530|3086636832)                       Application Id=2000, Vendor=0\r\n(22530|3086636832)                          Server = server.isp.net, metric = 2\r\n(22530|3086636832)      Default Route\r\n(22530|3086636832)              Route  : Realm = isp.net, Action = 0, Redirect-Usage = 0\r\n(22530|3086636832)                       Application Id=1, Vendor=0\r\n(22530|3086636832)                          Server = server.isp.net, metric = 5\r\n(22530|3086636832)            Max Sess : 10000\r\n(22530|3086636832)  Auth Stateful Auth : stateful\r\n(22530|3086636832)     Auth Session(T) : 30\r\n(22530|3086636832)    Auth Lifetime(T) : 360\r\n(22530|3086636832)       Auth Grace(T) : 30\r\n(22530|3086636832)       Auth Abort(T) : 20\r\n(22530|3086636832)     Acct Session(T) : 30\r\n(22530|3086636832)    Acct Interim Int : 5\r\n(22530|3086636832)      Acct Real-Time : 1\r\n(22530|3086636832)           Debug Log : enabled\r\n(22530|3086636832)           Trace Log : enabled\r\n(22530|3086636832)            Info Log : enabled\r\n(22530|3086636832)         Console Log : enabled\r\n(22530|3086636832)          Syslog Log : disabled\r\n Vendor [id = \"61\"]\r\n Vendor [name = \"Merit Networks\"]\r\n Vendor [id = \"42\"]\r\n Vendor [name = \"Sun Microsystems, Inc.\"]\r\n Vendor [id = \"429\"]\r\n Vendor [name = \"US Robotics Corp.\"]\r\n Base   [uri = \"ftp://ftp.ietf.org/internet-drafts/draft-ietf-aaa-diameter-08.txt\"]\r\n*** Cannot find AVP named Experimental-Result-Code ***\r\n  If Experimental-Result-Code is included inside a grouped avp, \r\n  make sure it's <avp> definition comes before \r\n  the <grouped> definition using it. If it is\r\n  not in a group, make sure it spelled properly\r\n  and there are no white-spaces.\r\nterminate called without an active exception\r\nAborted\r\n\r\n# \r\n#\r\n\r\n\r\nThank you for any suggestions on how to proceed to fix this problem!\r\nDMonte\r\n\r\n\r\n"
-
    name: tstcyanzi
    mail: ''
    subject: 'Hi~Do you still study opendiameter? I wish that we can discuss^^'
    hostname: 164.125.68.18
    created: '1260155929'
    body: "Hello, can we exchange some experiences?? \r\n\r\nI am a student that studying opendiameter, I met the following problems…\r\n\r\nIf you know how should I do next, I really really appreciate thant you can give me a reply…\r\n\r\nThe problems I met are like follow..\r\n\r\n\r\n--------------------------------------------------------------------------------\r\n\r\nwhen I test opendiameter daemon, sometimes aaa server & nas server fail to receive DWA, So the following phenomenon happens…\r\n\r\nAAA-NAS exchange CER/CEA,\r\n\r\nNAS sent first DER, AAA receive DER, and sent first DEA, then AAA-NAS can not exchange second DER & DEA, Since NAS can not receive DEA message, so NAS always re-transmit the first DER message…\r\n\r\nThanks a lot ^^ Best wishes for you~~~\r\n\r\n\r\n--------------------------------------------------------------------------------\r\n\r\nFollowing is some of nas server re-transmission log…\r\n\r\n(16989|3055410064) Peer Capabilities (16989|3055410064) Hostname : localaaa.localdomain1.net (16989|3055410064) Realm : localdomain1.net \r\n\r\n(16989|3055410064) Host IP : type=1, 127.0.0.1 (16989|3055410064) VendorId : 0 \r\n\r\n(16989|3055410064) Product Name : Open Diameter (16989|3055410064) Orig State : 1252287384 \r\n\r\n(16989|3055410064) Supported Vendor Id : 0 (16989|3055410064) Supported Vendor Id : 1\r\n\r\n(16989|3055410064) Auth Application Id : 1\r\n\r\n(16989|3055410064) Auth Application Id : 2\r\n\r\n(16989|3055410064) Auth Application Id : 5\r\n\r\n(16989|3055410064) Auth Application Id : 2000\r\n\r\n(16989|3055410064) Auth Application Id : 10000\r\n\r\n(16989|3055410064) Acct Application Id : 3\r\n\r\n(16989|3055410064) Acct Application Id : 4\r\n\r\n(16989|3055410064) Acct Application Id : 20000\r\n\r\n(16989|3055410064) Vendor Specific Id : (16989|3055410064) Vendor=31, Auth=1\r\n\r\n(16989|3055410064) Vendor Specific Id : (16989|3055410064) Vendor=41, Acct=6\r\n\r\n(16989|3055410064) Inband Sec : 0\r\n\r\n(16989|3055410064) Firmware Ver : 1\r\n\r\n(16989|3055410064) *** Local capabilities accepted by peer ***\r\n\r\n General configuration\r\n\r\n      Listen Port     : 1811\r\n\r\n      Dictionary      : /etc/opendiameter/nas/config/nasd_pana_dictionary.xml\r\n\r\n      Re-Transmission\r\n\r\n                 IRT  : 10\r\n\r\n                 MRC  : 3\r\n\r\n                 MRT  : 120\r\n\r\n                 MRD  : 120\r\n\r\n      Session-Lifetime: 10\r\n\r\n Client configuration\r\n\r\n       PAA IP Adress  : \r\n\r\n      PAA Port Number : 141991280\r\n\r\n EAP Response Timeout : 141989656\r\n\r\n        EAP Piggyback : 142143552\r\nDictionary loaded successfully\r\n\r\n(16989|3086882624) Initializing Diameter-EAP AAA protocol.***** float/clock time=0.040, unsigned time=1252287385*nasd_policy_script\r\n\r\n(16989|3065899920) RxPCI: id=0 seq=0. ***** float/clock time=1.450, unsigned time=1252287390*****\r\n\r\n(16989|3065899920) PAA is acting stateless\r\n\r\n(16989|3065899920) TxPSR: id=1252482254 seq=1983766533. ***** float/clock time=1.450, unsigned time=1252287390*pana_paa_factory\r\n\r\n(16989|3034430352) RxPSA: Stateless, id=1252482254 seq=1983766533. ***** float/clock time=1.490, unsigned time=1252287390*****\r\n\r\n(16989|3034430352) New session created [stateless handshake].***** float/clock time=1.500, unsigned time=1252287390*****\r\n\r\n(16989|3076389776) Event: 3 occurring\r\n\r\n(16989|3076389776) RxPSA: id=1252482254 seq=1983766533.***** float/clock time=1.500, unsigned time=1252287390*****\r\n\r\n(16989|3076389776) From state: OFFLINE to WAIT_SUCC_PBA. ***** float/clock time=1.500, unsigned time=1252287390*****\r\n\r\nPassThrough: Trying a legacy method.***** float/clock time=1.500, unsigned time=1252287390*****\r\n\r\nAuthIdentityStateTable: Request Prepared.***** float/clock time=1.500, unsigned time=1252287390*****\r\n\r\nPassthrough: Request sent and timer started.***** float/clock time=1.500, unsigned time=1252287390*****\r\n\r\n(16989|3076389776) Event: 96 occurring\r\n\r\n(16989|3076389776) TxPAR: id=1252482254 seq=1983766534.***** float/clock time=1.500, unsigned time=1252287390*****\r\n\r\n(16989|3076389776) From state: WAIT_SUCC_PBA to OPEN. ***** float/clock time=1.500, unsigned time=1252287390*****\r\n\r\n(16989|3034430352) Event: 2097157 occurring\r\n\r\n(16989|3034430352) RxPAN: id=1252482254 seq=1983766534. ***** float/clock time=1.570, unsigned time=1252287390*****\r\n\r\n(16989|3034430352) From state: OPEN to WAIT_SUCC_PBA. ***** float/clock time=1.570, unsigned time=1252287390*****\r\n\r\nPassthrough: Integrity Check.***** float/clock time=1.570, unsigned time=1252287390*****\r\n\r\nAuthIdentityStateTable: Do Identity Check.***** float/clock time=1.570, unsigned time=1252287390*****\r\n\r\n(16989|3034430352) Routing call for [testuser@localdomain1.net] using [testuser@localdomain1.net]. ***** float/clock time=1.570, unsigned time=1252287390*****\r\n\r\n(16989|3034430352) Call routed to [diameter_eap]\r\n\r\n(16989|3034430352) Session id=localnas.localdomain2.net.localdomain2.net;?^;. ***** float/clock time=1.580, unsigned time=1252287390*****\r\n\r\nPassthough: Integrity check.***** float/clock time=1.580, unsigned time=1252287390*****\r\n\r\n[] EAP-Response received from passthrough.Current Time:1252287390\r\n\r\n[] sending DER.***** float/clock time=1.580, unsigned time=1252287390*****\r\n\r\n(16989|3044920208) DestRealm(localdomain1.net) present (localdomain2.net) but not ours or no supported id***** float/clock time=1.580, unsigned time=1252287390***** Sent DER Message.***** float/clock time=1.580, unsigned time=1252287390*****\r\n\r\n(16989|3013450640) Waiting for incomming connection …\r\n\r\n(16989|3086879632) * Request message re-transmission ****.** float/clock time=5.770, unsigned time=1252287401*****\r\n\r\n(16989|3086879632) Message header dump\r\n\r\n      version = 1\r\n\r\n      length  = 276\r\n\r\n flags(r,p,e,t) = (1,1,0,1)\r\n\r\n      command = 268\r\n\r\n   hop-by-hop = 2040692035\r\n\r\n   end-to-end = 966563516\r\nApplication id = 5\r\n\r\n(16989|3086879632) DestRealm(localdomain1.net) present (localdomain2.net) but not ours or no supported id***** float/clock time=5.770, unsigned time=1252287401*****\r\n\r\n(16989|3013450640) Waiting for incomming connection …\r\n\r\n(16989|3086879632) * Request message re-transmission ****.** float/clock time=10.570, unsigned time=1252287413*****\r\n\r\n(16989|3086879632) Message header dump\r\n\r\n      version = 1\r\n\r\n      length  = 276\r\n\r\n flags(r,p,e,t) = (1,1,0,1)\r\n      command = 268\r\n\r\n   hop-by-hop = 2040692035\r\n\r\n   end-to-end = 966563516\r\nApplication id = 5\r\n\r\n(16989|3086879632) DestRealm(localdomain1.net) present (localdomain2.net) but not ours or no supported id***** float/clock time=10.570, unsigned time=1252287413*****\r\n\r\n(16989|3013450640) Waiting for incomming connection …\r\n\r\n(16989|3013450640) Waiting for incomming connection …\r\n\r\n(16989|3086879632) * Request message re-transmission ****.** float/clock time=15.290, unsigned time=1252287425*****\r\n\r\n(16989|3086879632) Message header dump\r\n\r\n      version = 1\r\n\r\n      length  = 276\r\n\r\n flags(r,p,e,t) = (1,1,0,1)\r\n\r\n      command = 268\r\n\r\n   hop-by-hop = 2040692035\r\n\r\n   end-to-end = 966563516\r\nApplication id = 5\r\n\r\n(16989|3086879632) DestRealm(localdomain1.net) present (localdomain2.net) but not ours or no supported id***** float/clock time=15.290, unsigned time=1252287425*****\r\n\r\n(16989|3013450640) Waiting for incomming connection …\r\n\r\n(16989|3086879632) **** Re-Transmission count exceeded, Request discarded ****\r\n"
