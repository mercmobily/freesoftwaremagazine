-
    name: siddiq
    mail: ''
    subject: 'Query Reg Free Radius Server'
    hostname: 203.196.144.50
    created: '1210768971'
    body: "Hai Gong Cheng\r\n\r\n     I need your help...\r\n\r\n I followed your steps to bring up Free Radius Server version 2.0.4. The first three test are pass. The Last Step 4. Full swing with EAP-TLS, EAP-TTLS and PEAP\r\n\r\nIn this I copied the default cert files (Server.pem, ca.pem, server.key) from /etc/raddb/certs to /home/siddiq/myCA/ and modified eap/conf file as below\r\n\r\nprivate_key_password = whatever\r\n- private_key_file = ${certdir}/server.pem\r\n+ #private_key_file = ${certdir}/server.pem\r\n+ private_key_file = /home/siddiq/myCA/server.key\r\n\r\n# If Private key & Certificate are located in\r\n# the same file, then private_key_file &\r\n@@ -157,7 +158,8 @@\r\n# only the server certificate, but ALSO all\r\n# of the CA certificates used to sign the\r\n# server certificate.\r\n- certificate_file = ${certdir}/server.pem\r\n+ #certificate_file = ${certdir}/server.pem\r\n+ certificate_file = /home/siddiq/myCA/server.pem\r\n\r\n# Trusted Root CA list\r\n#\r\n@@ -174,7 +176,8 @@\r\n# not use client certificates, and you do not want\r\n# to permit EAP-TLS authentication, then delete\r\n# this configuration item.\r\n- CA_file = ${cadir}/ca.pem\r\n+ #CA_file = ${cadir}/ca.pem\r\n+ CA_file = /home/siddiq/myCA/CA.pem\r\n\r\nIf I run eapol_test for PEAP\r\n\r\nI am not able to success. I am getting the following debug statement\r\n\r\n\r\nrad_recv: Access-Request packet from host 127.0.0.1 port 33244, id=0, length=124\r\n        User-Name = \"testuser\"\r\n        NAS-IP-Address = 127.0.0.1\r\n        Calling-Station-Id = \"02-00-00-00-00-01\"\r\n        Framed-MTU = 1400\r\n        NAS-Port-Type = Wireless-802.11\r\n        Connect-Info = \"CONNECT 11Mbps 802.11b\"\r\n        EAP-Message = 0x0200000d017465737475736572\r\n        Message-Authenticator = 0xe5a9f190f1064283b18a44f0788c5ab9\r\n+- entering group authorize\r\n++[preprocess] returns ok\r\n++[chap] returns noop\r\n++[mschap] returns noop\r\n    rlm_realm: No '@' in User-Name = \"testuser\", looking up realm NULL\r\n    rlm_realm: No such realm \"NULL\"\r\n++[suffix] returns noop\r\n  rlm_eap: EAP packet type response id 0 length 13\r\n  rlm_eap: No EAP Start, assuming it's an on-going EAP conversation\r\n++[eap] returns updated\r\n++[unix] returns notfound\r\n    users: Matched entry testuser at line 139\r\n++[files] returns ok\r\n++[expiration] returns noop\r\n++[logintime] returns noop\r\nrlm_pap: Found existing Auth-Type, not changing it.\r\n++[pap] returns noop\r\n  rad_check_password:  Found Auth-Type EAP\r\nauth: type \"EAP\"\r\n+- entering group authenticate\r\n  rlm_eap: EAP Identity\r\n  rlm_eap: processing type md5\r\nrlm_eap_md5: Issuing Challenge\r\n++[eap] returns handled\r\nSending Access-Challenge of id 0 to 127.0.0.1 port 33244\r\n        EAP-Message = 0x0101001604107474d895dff0602e1dc5dd36932c5388\r\n        Message-Authenticator = 0x00000000000000000000000000000000\r\n        State = 0x25d4c0ab25d5c4571f8c2d74b2e6c795\r\nFinished request 0.\r\nGoing to the next request\r\nWaking up in 4.9 seconds.\r\nrad_recv: Access-Request packet from host 127.0.0.1 port 33244, id=1, length=135\r\n        User-Name = \"testuser\"\r\n        NAS-IP-Address = 127.0.0.1\r\n        Calling-Station-Id = \"02-00-00-00-00-01\"\r\n        Framed-MTU = 1400\r\n        NAS-Port-Type = Wireless-802.11\r\n        Connect-Info = \"CONNECT 11Mbps 802.11b\"\r\n        EAP-Message = 0x020100060319\r\n        State = 0x25d4c0ab25d5c4571f8c2d74b2e6c795\r\n        Message-Authenticator = 0xc0707c39d7a339022069596e81509e0d\r\n+- entering group authorize\r\n++[preprocess] returns ok\r\n++[chap] returns noop\r\n++[mschap] returns noop\r\n    rlm_realm: No '@' in User-Name = \"testuser\", looking up realm NULL\r\n    rlm_realm: No such realm \"NULL\"\r\n++[suffix] returns noop\r\n  rlm_eap: EAP packet type response id 1 length 6\r\n  rlm_eap: No EAP Start, assuming it's an on-going EAP conversation\r\n++[eap] returns updated\r\n++[unix] returns notfound\r\n    users: Matched entry testuser at line 139\r\n++[files] returns ok\r\n++[expiration] returns noop\r\n++[logintime] returns noop\r\nrlm_pap: Found existing Auth-Type, not changing it.\r\n++[pap] returns noop\r\n  rad_check_password:  Found Auth-Type EAP\r\nauth: type \"EAP\"\r\n+- entering group authenticate\r\n  rlm_eap: Request found, released from the list\r\n  rlm_eap: EAP NAK\r\n rlm_eap: EAP-NAK asked for EAP-Type/peap\r\n  rlm_eap: processing type tls\r\n  rlm_eap_tls: Initiate\r\n  rlm_eap_tls: Start returned 1\r\n++[eap] returns handled\r\nSending Access-Challenge of id 1 to 127.0.0.1 port 33244\r\n        EAP-Message = 0x010200061920\r\n        Message-Authenticator = 0x00000000000000000000000000000000\r\n        State = 0x25d4c0ab24d6d9571f8c2d74b2e6c795\r\nFinished request 1.\r\nGoing to the next request\r\nWaking up in 4.9 seconds.\r\nrad_recv: Access-Request packet from host 127.0.0.1 port 33244, id=2, length=235\r\n        User-Name = \"testuser\"\r\nNAS-IP-Address = 127.0.0.1\r\n        Calling-Station-Id = \"02-00-00-00-00-01\"\r\n        Framed-MTU = 1400\r\n        NAS-Port-Type = Wireless-802.11\r\n        Connect-Info = \"CONNECT 11Mbps 802.11b\"\r\n        EAP-Message = 0x0202006a1900160301005f0100005b03014829fe0143247c2c8e89d5d6386a2039639b779f3fdae0aa932364c83a11f28100003400390038003500160013000a00330032002f006600050004006300620061001500120009006500640060001400110008000600030100\r\n        State = 0x25d4c0ab24d6d9571f8c2d74b2e6c795\r\n        Message-Authenticator = 0x3ab143c344058f47b4f8221fb8d94939\r\n+- entering group authorize\r\n++[preprocess] returns ok\r\n++[chap] returns noop\r\n++[mschap] returns noop\r\n    rlm_realm: No '@' in User-Name = \"testuser\", looking up realm NULL\r\n    rlm_realm: No such realm \"NULL\"\r\n++[suffix] returns noop\r\n  rlm_eap: EAP packet type response id 2 length 106\r\n  rlm_eap: Continuing tunnel setup.\r\n++[eap] returns ok\r\n  rad_check_password:  Found Auth-Type EAP\r\nauth: type \"EAP\"\r\n+- entering group authenticate\r\n  rlm_eap: Request found, released from the list\r\n  rlm_eap: EAP/peap\r\n  rlm_eap: processing type peap\r\n  rlm_eap_peap: Authenticate\r\n  rlm_eap_tls: processing TLS\r\n  eaptls_verify returned 7\r\n  rlm_eap_tls: Done initial handshake\r\n    (other): before/accept initialization\r\n    TLS_accept: before/accept initialization\r\n  rlm_eap_tls: <<< TLS 1.0 Handshake [length 005f], ClientHello\r\n    TLS_accept: SSLv3 read client hello A\r\n  rlm_eap_tls: >>> TLS 1.0 Handshake [length 004a], ServerHello\r\n    TLS_accept: SSLv3 write server hello A\r\n  rlm_eap_tls: >>> TLS 1.0 Handshake [length 084e], Certificate\r\n    TLS_accept: SSLv3 write certificate A\r\n  rlm_eap_tls: >>> TLS 1.0 Handshake [length 020d], ServerKeyExchange\r\n    TLS_accept: SSLv3 write key exchange A\r\n  rlm_eap_tls: >>> TLS 1.0 Handshake [length 0004], ServerHelloDone\r\n    TLS_accept: SSLv3 write server done A\r\n    TLS_accept: SSLv3 flush data\r\n    TLS_accept: Need to read more data: SSLv3 read client certificate A\r\nIn SSL Handshake Phase\r\nIn SSL Accept mode\r\n  eaptls_process returned 13\r\n  rlm_eap_peap: EAPTLS_HANDLED\r\n++[eap] returns handled\r\nSending Access-Challenge of id 3 to 127.0.0.1 port 33244\r\n        EAP-Message = 0x010403fc1940b44fc78411cc6b70be8401f0726f00049b308204973082037fa003020102020100300d06092a864886f70d0101040500308193310b3009060355040613024652310f300d060355040813065261646975733112301006035504071309536f6d65776865726531153013060355040a130c4578616d706c6520496e632e3120301e06092a864886f70d010901161161646d696e406578616d706c652e636f6d312630240603550403131d4578616d706c6520436572746966696361746520417574686f72697479301e170d3038303531323030333830315a170d3038303631313030333830315a308193310b300906035504061302465231\r\n        EAP-Message = 0x0f300d060355040813065261646975733112301006035504071309536f6d65776865726531153013060355040a130c4578616d706c6520496e632e3120301e06092a864886f70d010901161161646d696e406578616d706c652e636f6d312630240603550403131d4578616d706c6520436572746966696361746520417574686f7269747930820122300d06092a864886f70d01010105000382010f003082010a0282010100bf6ddff8e9b3855a4ccaad02332fdb44517c5cefdf5a82231c22c302ecfa251c49cbe630048dc275bbbbe88d47ddd2448b94158d891d6662e0d24c281ebda133451fe9084d99062533020b29fccce21e009a2e583d1d13\r\n        EAP-Message = 0xbc519b75c7837be01bd13752fae309b66074a5d08cc8551eeedd4e998ee398d801b7a62430a025406d3a7a19a86ae752b9144ec69a4913e5836e7b8e126281e2755956c9935ddc227e7357780a62cf08cee60239bfb92c5d633bd884debc8448947b4d7e199689ce885bd5d3b891a765711ab0b6762a0745f0079835b7a61eefa897060e789b46643311b207368c159c1ec7ffa889ed554ded65e79d7a5282e0200db541db86574c290203010001a381f33081f0301d0603551d0e041604141401a0b92fe69af3fd85953bf4e5de695c8dcc193081c00603551d230481b83081b580141401a0b92fe69af3fd85953bf4e5de695c8dcc19a18199a48196\r\n        EAP-Message = 0x308193310b3009060355040613024652310f300d060355040813065261646975733112301006035504071309536f6d65776865726531153013060355040a130c4578616d706c6520496e632e3120301e06092a864886f70d010901161161646d696e406578616d706c652e636f6d312630240603550403131d4578616d706c6520436572746966696361746520417574686f72697479820100300c0603551d13040530030101ff300d06092a864886f70d010104050003820101006a88994999307475276b2e48e691e0041cc59d6b11ecd5395e0f800b8ec4653d14ba3b2204d98af2b8e5071ec3575a379cc98199421c527cbdc85415ec93a61fe1e4\r\n        EAP-Message = 0x35c35e68a690f7ef\r\n        Message-Authenticator = 0x00000000000000000000000000000000\r\n        State = 0x25d4c0ab26d0d9571f8c2d74b2e6c795\r\nFinished request 3.\r\nGoing to the next request\r\nWaking up in 4.9 seconds.\r\nrad_recv: Access-Request packet from host 127.0.0.1 port 33244, id=4, length=135\r\n        User-Name = \"testuser\"\r\n        NAS-IP-Address = 127.0.0.1\r\n        Calling-Station-Id = \"02-00-00-00-00-01\"\r\n        Framed-MTU = 1400\r\n        NAS-Port-Type = Wireless-802.11\r\n        Connect-Info = \"CONNECT 11Mbps 802.11b\"\r\n        EAP-Message = 0x020400061900\r\n        State = 0x25d4c0ab26d0d9571f8c2d74b2e6c795\r\n        Message-Authenticator = 0x7ba134599084f914ffcb4e2db2e7001b\r\n+- entering group authorize\r\n++[preprocess] returns ok\r\n++[chap] returns noop\r\n++[mschap] returns noop\r\n    rlm_realm: No '@' in User-Name = \"testuser\", looking up realm NULL\r\n    rlm_realm: No such realm \"NULL\"\r\n++[suffix] returns noop\r\n  rlm_eap: EAP packet type response id 4 length 6\r\n  rlm_eap: Continuing tunnel setup.\r\n++[eap] returns ok\r\n  rad_check_password:  Found Auth-Type EAP\r\nauth: type \"EAP\"\r\n+- entering group authenticate\r\n  rlm_eap: Request found, released from the list\r\n  rlm_eap: EAP/peap\r\n  rlm_eap: processing type peap\r\n  rlm_eap_peap: Authenticate\r\n  rlm_eap_tls: processing TLS\r\nrlm_eap_tls: Received EAP-TLS ACK message\r\n  rlm_eap_tls: ack handshake fragment handler\r\n  eaptls_verify returned 1\r\n  eaptls_process returned 13\r\n  rlm_eap_peap: EAPTLS_HANDLED\r\n++[eap] returns handled\r\nSending Access-Challenge of id 4 to 127.0.0.1 port 33244\r\n        EAP-Message = 0x010502d71900163ca5c24d38b05dccd115f5ff90644f27b87236671016f421574a535ad460a2944331f59f92560cb8530fa4df4d082db1dceb63adfa77e547fb6981096eedd50c8e6dd36e5fce2ba9593899ab18f5b8d6e46fdeeaff6e90230b05cb1e49fe608a54f5496c2d2d6e9a58f46ee995dbab78ddab6978cbad60bc28b1932a905fd2edf40108a9efeecf596e232cd3e0ac736d0d425dad81b18cd46a677c37d41a0639484bde2662e6f1e663e47960db45684a0e21d1bcfe160301020d0c0002090080d72466c9f52b47658a16747a69274cc3be91ef30a47d9b72fb36c47394bd3309dc93cfa2827b596274e2e731050bb1f0ee74a8173975\r\n        EAP-Message = 0x55b8a07a2c173c9e40a00bd4cc3aeadfca4c034c6f7c687aaa27efe47ce6667f9e043bdf6752476617f1c2136ec69f83ddecbb0f5fc835ac041f25425638085904f98fd393ef046214fb0001020080254a2fe641a9db58fab69951d8cff6ce4f0acc0c2d5e7d3c3348a382ab4fd82e7b3a676078f67ae0ce88b14fe89ba4efb96d87129edbb8d6de5f5e25750e03ccb1768867144a4db766d30d39f38390dd1bd38e700c8bd7d7f74d39cc7164929232acf31419728b99ccfff096fce4afdfd28b4fd65d3752de4111cb2ecf371f7c01002f2a3966854bf62bf6038526f34097a6d26ffd6629491ded5eb3ed30f6a599c3b85226d545d57092a19ff013\r\n        EAP-Message = 0xfb814545e3d6a7721014b9878e9d7c07c98f8cb3d0aab36ef1c19540e2386a98d6663db167835967db77a76431c4593b332e1dc3a7a827a397862f176950a9c2b2556e1b5296aa7c839b1f0b16aa1b48ddeaa8b62b06505092fdb1fb9cf9a2ddbc36656a82fb22985d2af454fc2133e34a88ba180615154dc17abb5f1474ab4470575f66d27e1c915846930600a424d4841c15b43a115003f337724e86f3f76b42c7824cdccd2a7f80dcc0a8f13ccb2404b14e811e64c44002f257f87ef39e1b5a06f9a8f8e2d79243a745b09955773f013baeff16030100040e000000\r\n        Message-Authenticator = 0x00000000000000000000000000000000\r\n        State = 0x25d4c0ab21d1d9571f8c2d74b2e6c795\r\nFinished request 4.\r\nGoing to the next request\r\nWaking up in 4.8 seconds.\r\nrad_recv: Access-Request packet from host 127.0.0.1 port 33244, id=5, length=333\r\n        User-Name = \"testuser\"\r\n        NAS-IP-Address = 127.0.0.1\r\n        Calling-Station-Id = \"02-00-00-00-00-01\"\r\n        Framed-MTU = 1400\r\n        NAS-Port-Type = Wireless-802.11\r\n        Connect-Info = \"CONNECT 11Mbps 802.11b\"\r\n        EAP-Message = 0x020500cc1900160301008610000082008040489574e97f9dfac9ff46e793008a6b37f761cfa7411e4ff798670a7e899086c00fed6b4f5bf586d9d0ef16b0dcd6633a30600cc03408597c57f8170286ff7e2da47c73fe464f2a77f797436dd5cf543febf81c22f096fe3a5293894933cd9797f1802f2937052c86ab964f7d021c821569f76d685f91e88d4b8b4232e4a8ea1403010001011603010030e62430122aabd720ad60b9cffa7052344cb96fa808ad2c1836ca82934350b9e6d5425b86bb5c257f7f4e021b9d4ded0c\r\n        State = 0x25d4c0ab21d1d9571f8c2d74b2e6c795\r\n        Message-Authenticator = 0x5eb31b0f3a74ea7d50ee162b8fdd1c47\r\n+- entering group authorize\r\n++[preprocess] returns ok\r\n++[chap] returns noop\r\n++[mschap] returns noop\r\nrlm_realm: No '@' in User-Name = \"testuser\", looking up realm NULL\r\n    rlm_realm: No such realm \"NULL\"\r\n++[suffix] returns noop\r\n  rlm_eap: EAP packet type response id 5 length 204\r\n  rlm_eap: Continuing tunnel setup.\r\n++[eap] returns ok\r\n  rad_check_password:  Found Auth-Type EAP\r\nauth: type \"EAP\"\r\n+- entering group authenticate\r\n  rlm_eap: Request found, released from the list\r\n  rlm_eap: EAP/peap\r\n  rlm_eap: processing type peap\r\n  rlm_eap_peap: Authenticate\r\n  rlm_eap_tls: processing TLS\r\n  eaptls_verify returned 7\r\n  rlm_eap_tls: Done initial handshake\r\n  rlm_eap_tls: <<< TLS 1.0 Handshake [length 0086], ClientKeyExchange\r\n    TLS_accept: SSLv3 read client key exchange A\r\n  rlm_eap_tls: <<< TLS 1.0 ChangeCipherSpec [length 0001]\r\n  rlm_eap_tls: <<< TLS 1.0 Handshake [length 0010], Finished\r\n    TLS_accept: SSLv3 read finished A\r\n  rlm_eap_tls: >>> TLS 1.0 ChangeCipherSpec [length 0001]\r\n    TLS_accept: SSLv3 write change cipher spec A\r\n  rlm_eap_tls: >>> TLS 1.0 Handshake [length 0010], Finished\r\n    TLS_accept: SSLv3 write finished A\r\n    TLS_accept: SSLv3 flush data\r\n    (other): SSL negotiation finished successfully\r\nSSL Connection Established\r\n  eaptls_process returned 13\r\n  rlm_eap_peap: EAPTLS_HANDLED\r\n++[eap] returns handled\r\nSending Access-Challenge of id 5 to 127.0.0.1 port 33244\r\n        EAP-Message = 0x010600411900140301000101160301003012a0472419a814369e65106b484b8f40e9f051e72a1f71fd9ff08201bdaa5a15a94be74d5929bab23f389083312c6598\r\n        Message-Authenticator = 0x00000000000000000000000000000000\r\n        State = 0x25d4c0ab20d2d9571f8c2d74b2e6c795\r\nFinished request 5.\r\nGoing to the next request\r\nWaking up in 4.7 seconds.\r\nrad_recv: Access-Request packet from host 127.0.0.1 port 33244, id=6, length=135\r\n        User-Name = \"testuser\"\r\n        NAS-IP-Address = 127.0.0.1\r\n        Calling-Station-Id = \"02-00-00-00-00-01\"\r\n        Framed-MTU = 1400\r\n        NAS-Port-Type = Wireless-802.11\r\n        Connect-Info = \"CONNECT 11Mbps 802.11b\"\r\n        EAP-Message = 0x020600061900\r\n        State = 0x25d4c0ab20d2d9571f8c2d74b2e6c795\r\n                                                                                                                                           Message-Authenticator = 0x32e2251583c149e5e0dd5a2d1d819c48\r\n+- entering group authorize\r\n++[preprocess] returns ok\r\n++[chap] returns noop\r\n++[mschap] returns noop\r\n    rlm_realm: No '@' in User-Name = \"testuser\", looking up realm NULL\r\n    rlm_realm: No such realm \"NULL\"\r\n++[suffix] returns noop\r\n  rlm_eap: EAP packet type response id 6 length 6\r\n  rlm_eap: Continuing tunnel setup.\r\n++[eap] returns ok\r\n  rad_check_password:  Found Auth-Type EAP\r\nauth: type \"EAP\"\r\n+- entering group authenticate\r\n  rlm_eap: Request found, released from the list\r\n  rlm_eap: EAP/peap\r\n  rlm_eap: processing type peap\r\n  rlm_eap_peap: Authenticate\r\n  rlm_eap_tls: processing TLS\r\nrlm_eap_tls: Received EAP-TLS ACK message\r\n  rlm_eap_tls: ack handshake is finished\r\n  eaptls_verify returned 3\r\n  eaptls_process returned 3\r\n  rlm_eap_peap: EAPTLS_SUCCESS\r\n++[eap] returns handled\r\nSending Access-Challenge of id 6 to 127.0.0.1 port 33244\r\n        EAP-Message = 0x0107002b190017030100203fbd523ca0adb7b7177cae0e662d32f51601b619d36168b065bc93a1b99f9ca1\r\n        Message-Authenticator = 0x00000000000000000000000000000000\r\n        State = 0x25d4c0ab23d3d9571f8c2d74b2e6c795\r\nFinished request 6.\r\nGoing to the next request\r\nWaking up in 4.6 seconds.\r\nrad_recv: Access-Request packet from host 127.0.0.1 port 33244, id=7, length=209\r\n        User-Name = \"testuser\"\r\n        NAS-IP-Address = 127.0.0.1\r\n        Calling-Station-Id = \"02-00-00-00-00-01\"\r\n        Framed-MTU = 1400\r\n        NAS-Port-Type = Wireless-802.11\r\n        Connect-Info = \"CONNECT 11Mbps 802.11b\"\r\n        EAP-Message = 0x02070050190017030100208fc24c8474006a4993ee2d8f7bca83ee051b7ee79ad089c64b10267ce15862b31703010020e51b4ec6c4f32906f34148e833898294af02829e78ab3b4a4b33c9648a6e2bca\r\n State = 0x25d4c0ab23d3d9571f8c2d74b2e6c795\r\n        Message-Authenticator = 0x52fd8cf6b199c3f735ab8f84a28ffce6\r\n+- entering group authorize\r\n++[preprocess] returns ok\r\n++[chap] returns noop\r\n++[mschap] returns noop\r\n    rlm_realm: No '@' in User-Name = \"testuser\", looking up realm NULL\r\n    rlm_realm: No such realm \"NULL\"\r\n++[suffix] returns noop\r\n  rlm_eap: EAP packet type response id 7 length 80\r\n  rlm_eap: Continuing tunnel setup.\r\n++[eap] returns ok\r\n  rad_check_password:  Found Auth-Type EAP\r\nauth: type \"EAP\"\r\n+- entering group authenticate\r\n  rlm_eap: Request found, released from the list\r\n  rlm_eap: EAP/peap\r\n  rlm_eap: processing type peap\r\n  rlm_eap_peap: Authenticate\r\n  rlm_eap_tls: processing TLS\r\n  eaptls_verify returned 7\r\n  rlm_eap_tls: Done initial handshake\r\n  eaptls_process returned 7\r\n  rlm_eap_peap: EAPTLS_OK\r\n  rlm_eap_peap: Session established.  Decoding tunneled attributes.\r\n  rlm_eap_peap: Identity - testuser\r\n  PEAP: Got tunneled EAP-Message\r\n        EAP-Message = 0x0207000d017465737475736572\r\n  PEAP: Got tunneled identity of testuser\r\n  PEAP: Setting default EAP type for tunneled EAP session.\r\n  PEAP: Setting User-Name to testuser\r\n  PEAP: Sending tunneled request\r\n        EAP-Message = 0x0207000d017465737475736572\r\n        FreeRADIUS-Proxied-To = 127.0.0.1\r\n        User-Name = \"testuser\"\r\nserver inner-tunnel {\r\n+- entering group authorize\r\n++[chap] returns noop\r\n++[mschap] returns noop\r\n++[unix] returns notfound\r\n    rlm_realm: No '@' in User-Name = \"testuser\", looking up realm NULL\r\n    rlm_realm: No such realm \"NULL\"\r\n++[suffix] returns noop\r\n++[control] returns noop\r\n  rlm_eap: EAP packet type response id 7 length 13\r\n  rlm_eap: No EAP Start, assuming it's an on-going EAP conversation\r\n++[eap] returns updated\r\n++[files] returns noop\r\n++[expiration] returns noop\r\n++[logintime] returns noop\r\n++[pap] returns noop\r\n  rad_check_password:  Found Auth-Type EAP\r\nauth: type \"EAP\"\r\n+- entering group authenticate\r\n  rlm_eap: EAP Identity\r\n  rlm_eap: processing type mschapv2\r\nrlm_eap_mschapv2: Issuing Challenge\r\n++[eap] returns handled\r\n} # server inner-tunnel\r\n  PEAP: Got tunneled reply RADIUS code 11\r\n        EAP-Message = 0x010800221a0108001d10895c9341f4306d7c524791def93aa3747465737475736572\r\n        Message-Authenticator = 0x00000000000000000000000000000000\r\n        State = 0x0a790fba0a7115e3aa83a67fc6c0586d\r\n  PEAP: Processing from tunneled session code 0x81a05a8 11\r\n        EAP-Message = 0x010800221a0108001d10895c9341f4306d7c524791def93aa3747465737475736572\r\n        Message-Authenticator = 0x00000000000000000000000000000000\r\n        State = 0x0a790fba0a7115e3aa83a67fc6c0586d\r\n  PEAP: Got tunneled Access-Challenge\r\n++[eap] returns handled\r\nSending Access-Challenge of id 7 to 127.0.0.1 port 33244\r\n        EAP-Message = 0x0108004b19001703010040f9376522c88a67f04537e96c8456d27b7667386f920cbf3f17e21c6b6a7da9062fd11d500aa2fa6cac107541754960f3867f914851d63c5a64c31a28f27d5727\r\n        Message-Authenticator = 0x00000000000000000000000000000000\r\n        State = 0x25d4c0ab22dcd9571f8c2d74b2e6c795\r\nFinished request 7.\r\nGoing to the next request\r\nWaking up in 4.6 seconds.\r\nrad_recv: Access-Request packet from host 127.0.0.1 port 33244, id=8, length=273\r\n        User-Name = \"testuser\"\r\n        NAS-IP-Address = 127.0.0.1\r\n        Calling-Station-Id = \"02-00-00-00-00-01\"\r\n        Framed-MTU = 1400\r\n        NAS-Port-Type = Wireless-802.11\r\n        Connect-Info = \"CONNECT 11Mbps 802.11b\"\r\n        EAP-Message = 0x02080090190017030100204848d0fb1e9eb103ba11707814c1dd214388e8929aec19dbaf8f340305ca9d8a17030100609b589a0907ba16dd0e0b9e4001ba32a838b4dec4d431582a800ac3d70918b49f458cb899380a03244a59f8d443bd0bcb8815390393c3a842dc691a6547b4a9a4968083064c288d4a9b964e301f6038c019ddcaa07ce27b262d2219281fe9a5f6\r\n        State = 0x25d4c0ab22dcd9571f8c2d74b2e6c795\r\n        Message-Authenticator = 0x04ab3a0d8755fc19903b7fa00cf7c2d8\r\n+- entering group authorize\r\n++[preprocess] returns ok\r\n++[chap] returns noop\r\n++[mschap] returns noop\r\n rlm_realm: No '@' in User-Name = \"testuser\", looking up realm NULL\r\n    rlm_realm: No such realm \"NULL\"\r\n++[suffix] returns noop\r\n  rlm_eap: EAP packet type response id 8 length 144\r\n  rlm_eap: Continuing tunnel setup.\r\n++[eap] returns ok\r\n  rad_check_password:  Found Auth-Type EAP\r\nauth: type \"EAP\"\r\n+- entering group authenticate\r\n  rlm_eap: Request found, released from the list\r\n  rlm_eap: EAP/peap\r\n  rlm_eap: processing type peap\r\n  rlm_eap_peap: Authenticate\r\n  rlm_eap_tls: processing TLS\r\n  eaptls_verify returned 7\r\n  rlm_eap_tls: Done initial handshake\r\n  eaptls_process returned 7\r\n  rlm_eap_peap: EAPTLS_OK\r\n  rlm_eap_peap: Session established.  Decoding tunneled attributes.\r\n  rlm_eap_peap: EAP type mschapv2\r\n  PEAP: Got tunneled EAP-Message\r\n        EAP-Message = 0x020800431a0208003e317f0d5379952a2f9677da270f4756151c0000000000000000ebd60209fe4dba946c453654d98590bcc5ff1c9f3ba7ed69007465737475736572\r\n  PEAP: Setting User-Name to testuser\r\n  PEAP: Sending tunneled request\r\n        EAP-Message = 0x020800431a0208003e317f0d5379952a2f9677da270f4756151c0000000000000000ebd60209fe4dba946c453654d98590bcc5ff1c9f3ba7ed69007465737475736572\r\n        FreeRADIUS-Proxied-To = 127.0.0.1\r\n        User-Name = \"testuser\"\r\n        State = 0x0a790fba0a7115e3aa83a67fc6c0586d\r\nserver inner-tunnel {\r\n+- entering group authorize\r\n++[chap] returns noop\r\n++[mschap] returns noop\r\n++[unix] returns notfound\r\n    rlm_realm: No '@' in User-Name = \"testuser\", looking up realm NULL\r\n    rlm_realm: No such realm \"NULL\"\r\n++[suffix] returns noop\r\n++[control] returns noop\r\n  rlm_eap: EAP packet type response id 8 length 67\r\n  rlm_eap: No EAP Start, assuming it's an on-going EAP conversation\r\n++[eap] returns updated\r\n++[files] returns noop\r\n++[expiration] returns noop\r\n++[logintime] returns noop\r\n++[pap] returns noop\r\n  rad_check_password:  Found Auth-Type EAP\r\nauth: type \"EAP\"\r\n+- entering group authenticate\r\n  rlm_eap: Request found, released from the list\r\n  rlm_eap: EAP/mschapv2\r\n  rlm_eap: processing type mschapv2\r\n+- entering group MS-CHAP\r\n  rlm_mschap: No Cleartext-Password configured.  Cannot create LM-Password.\r\n  rlm_mschap: No Cleartext-Password configured.  Cannot create NT-Password.\r\n  rlm_mschap: Told to do MS-CHAPv2 for testuser with NT-Password\r\n  rlm_mschap: FAILED: No NT/LM-Password.  Cannot perform authentication.\r\n  rlm_mschap: FAILED: MS-CHAP2-Response is incorrect\r\n++[mschap] returns reject\r\n  rlm_eap: Freeing handler\r\n++[eap] returns reject\r\nauth: Failed to validate the user.\r\nLogin incorrect: [testuser/<via Auth-Type = EAP>] (from client localhost port 0 via TLS tunnel)\r\n} # server inner-tunnel\r\n  PEAP: Got tunneled reply RADIUS code 3\r\n        MS-CHAP-Error = \"\\010E=691 R=1\"\r\n        EAP-Message = 0x04080004\r\n        Message-Authenticator = 0x00000000000000000000000000000000\r\n  PEAP: Processing from tunneled session code 0x81a2260 3\r\n        MS-CHAP-Error = \"\\010E=691 R=1\"\r\n        EAP-Message = 0x04080004\r\n        Message-Authenticator = 0x00000000000000000000000000000000\r\n  PEAP: Tunneled authentication was rejected.\r\n  rlm_eap_peap: FAILURE\r\n++[eap] returns handled\r\nSending Access-Challenge of id 8 to 127.0.0.1 port 33244\r\n        EAP-Message = 0x0109002b19001703010020ff35055008bd3da286154685ee9222fe7d3d587e9d0dc70f58aea78dc6f3183e\r\n        Message-Authenticator = 0x00000000000000000000000000000000\r\n        State = 0x25d4c0ab2dddd9571f8c2d74b2e6c795\r\nFinished request 8.\r\nGoing to the next request\r\nWaking up in 4.5 seconds.\r\nrad_recv: Access-Request packet from host 127.0.0.1 port 33244, id=9, length=209\r\n        User-Name = \"testuser\"\r\n        NAS-IP-Address = 127.0.0.1\r\n        Calling-Station-Id = \"02-00-00-00-00-01\"\r\n        Framed-MTU = 1400\r\n        NAS-Port-Type = Wireless-802.11\r\n        Connect-Info = \"CONNECT 11Mbps 802.11b\"\r\n        EAP-Message = 0x02090050190017030100206c355b3c47c7c3eae9cd4197123a34c646d9efde9ee5c4f8320b51ba2d995c041703010020b24577b840dddbcd636a5b695dc263bc0f161dcdfc438a38c726a133a3dbd714\r\n        State = 0x25d4c0ab2dddd9571f8c2d74b2e6c795\r\n        Message-Authenticator = 0x0eff184ac45c541649a24f866b20d52f\r\n+- entering group authorize\r\n++[preprocess] returns ok\r\n++[chap] returns noop\r\n++[mschap] returns noop\r\n    rlm_realm: No '@' in User-Name = \"testuser\", looking up realm NULL\r\n    rlm_realm: No such realm \"NULL\"\r\n++[suffix] returns noop\r\n  rlm_eap: EAP packet type response id 9 length 80\r\n  rlm_eap: Continuing tunnel setup.\r\n++[eap] returns ok\r\n  rad_check_password:  Found Auth-Type EAP\r\nauth: type \"EAP\"\r\n+- entering group authenticate\r\n  rlm_eap: Request found, released from the list\r\n  rlm_eap: EAP/peap\r\n  rlm_eap: processing type peap\r\n  rlm_eap_peap: Authenticate\r\n  rlm_eap_tls: processing TLS\r\n  eaptls_verify returned 7\r\n  rlm_eap_tls: Done initial handshake\r\n  eaptls_process returned 7\r\n  rlm_eap_peap: EAPTLS_OK\r\n  rlm_eap_peap: Session established.  Decoding tunneled attributes.\r\n  rlm_eap_peap: Received EAP-TLV response.\r\n  rlm_eap_peap:  Had sent TLV failure.  User was rejected earlier in this session.\r\n rlm_eap: Handler failed in EAP/peap\r\n  rlm_eap: Failed in EAP select\r\n++[eap] returns invalid\r\nauth: Failed to validate the user.\r\nLogin incorrect: [testuser/<via Auth-Type = EAP>] (from client localhost port 0 cli 02-00-00-00-00-01)\r\n  Found Post-Auth-Type Reject\r\n+- entering group REJECT\r\n        expand: %{User-Name} -> testuser\r\n attr_filter: Matched entry DEFAULT at line 11\r\n++[attr_filter.access_reject] returns updated\r\nDelaying reject of request 9 for 1 seconds\r\nGoing to the next request\r\nWaking up in 0.9 seconds.\r\nSending delayed reject for request 9\r\nSending Access-Reject of id 9 to 127.0.0.1 port 33244\r\n        EAP-Message = 0x04090004\r\n        Message-Authenticator = 0x00000000000000000000000000000000\r\nWaking up in 3.5 seconds.\r\nCleaning up request 0 ID 0 with timestamp +9\r\nCleaning up request 1 ID 1 with timestamp +9\r\nCleaning up request 2 ID 2 with timestamp +10\r\nCleaning up request 3 ID 3 with timestamp +10\r\nCleaning up request 4 ID 4 with timestamp +\r\n\r\n\r\nPlease Help In this Regard..."
-
    name: 'Gong Cheng'
    mail: ''
    subject: reply
    hostname: 75.26.137.116
    created: '1210958463'
    body: "hi siddiq, sorry for the late response,\r\n\r\nthe following in the log shows the failure\r\n=CODE_START=\r\n+- entering group MS-CHAP\r\nrlm_mschap: No Cleartext-Password configured. Cannot create LM-Password.\r\nrlm_mschap: No Cleartext-Password configured. Cannot create NT-Password.\r\nrlm_mschap: Told to do MS-CHAPv2 for testuser with NT-Password\r\nrlm_mschap: FAILED: No NT/LM-Password. Cannot perform authentication.\r\nrlm_mschap: FAILED: MS-CHAP2-Response is incorrect\r\n++[mschap] returns reject\r\nrlm_eap: Freeing handler\r\n++[eap] returns reject\r\nauth: Failed to validate the user.\r\nLogin incorrect: [testuser/] (from client localhost port 0 via TLS tunnel)\r\n=CODE_END=\r\n\r\nsomehow your radiusd is not able to find a password for your inner/tunnelled identity. I am not sure if the trailing \"/\" after \"testuser\" has anything to do with it.\r\n\r\nCould you double check your eapol_test's config file and your users file's matching entry (line 139?)?\r\n\r\nthanks.\r\n"
-
    name: siddiq
    mail: ''
    subject: 'Login Problem in Free Radius Server'
    hostname: 203.196.144.50
    created: '1211168368'
    body: "Hi Gong,\r\n\r\n  Thanks for your reply. \r\n\r\n  I did the following modification in the eap.conf file. I commented the line Virtual_Server = \"innner tunnel\" under PEAP module\r\n\r\nAfter that If I run the eapol_test, I got the \"Access Accept\". Now I am using Windows XP (SP 1) Laptop as a client. For this I am getting the same error. \"Login Incorrect. What are the procedure need to do while using Windows clients to authenticate in to the Free Radius Server?. whether any certificates need to create and install in the Windows Vista Laptop?. or Need to configure any databases, if yes, how to configure that. Please help me. Thanks for your help in advance.\r\n\r\nThanks & Regards,\r\nSiddiq\r\n"
-
    name: 'Gong Cheng'
    mail: ''
    subject: windows
    hostname: 75.26.137.116
    created: '1211994691'
    body: "Hi Siddiq, again sorry for the late response. (I did get a email notification each time there was an update on the post, however, when I click it right away at receiving the email, it was always too early or somehow and the update won't show up until later...)\r\n\r\nAs for windows clients, I could only speak from experience. \r\n\r\nYes, \r\n- if you use any of EAP-TTLS/PEAP/EAP-TLS, you would at least need to install a root CA certificate on it.\r\n- for EAP-TLS, you will also need the client cert and key. (note: windows native system doesn't accept .pem format, but accept a converted format of .der (which has both cert and key))\r\n- when you use openssl to generate your certs, you will need to make sure both server certificate and client certificate are generated with xp extensions. (and server with server extension, client with client extension). The CA.all script provide that support. You can probably also google it on how to generate it with xpextensions.\r\n\r\n- if you run some other supplicant like xsupplicant on your windows, it might be different story, and you may just be able to use the certs as if on a linux system, but I haven't tried that so can't say much."
-
    name: alex_from_italy
    mail: ''
    subject: 'Problems in generating client certificates'
    hostname: 81.208.60.206
    created: '1216466857'
    body: "Hi\r\n\r\nI've found your article quite interesting. I've followed all your instructions, but I can't use the TLS authentication.\r\nI should generate client certificate, is it correct? Since, as you said, also the client have to show its credentials.\r\nSurfing the net, I've seen that I should use the Makefile into /certs folder. But I cant'. \r\n\r\nWhat's the correct procedure to create client certificate? The certificates I've to use in the eappol_test.conf.tls (something like this) in particular way in the private_key e client_cert field.\r\n\r\nThanks\r\n\r\nAlessandro."
-
    name: alex_from_italy
    mail: ''
    subject: 'Problems with remote step4'
    hostname: 78.15.124.188
    created: '1218012634'
    body: "Hi. I've a Ubuntu 7.10 and a FreeRadius 2.0.5 installed on my machine. I've configured my environment according to your great article. When I test my server in local way (loopback address 127.0.0.1), all works (except for EAP-TLS, but I haven't tried so much to fix the problem).\r\n \r\nAnyway, I need to test my server remotly. I've linked two different machines with Ubuntu 7.10 through a Ethernet cable. In the one when I'm testing the server I've installed only the FreeRadius Server, nothing else. The configuration passes all the first three steps. But when I try to test my server with eapol_test I catch a FAILURE. I've copied the dir (/home/alex/myCA) of the original server (the one which locally works) in (/home/francesco/myCA) in a dir into the remote server (the one which doesn't work) and modified all the references in eap.conf replacing alex with francesco. Notice that I've copied the etc/raddb from the server which locally worked to the one which now, remotly, doesn't work (adding one entry to the users file).\r\n\r\nHere what I catch when I try to test my server remotly with a conf file which worked locally.\r\n\r\nServer: Listening on authentication address * port 1812\r\nListening on accounting address * port 1813\r\nListening on proxy address * port 1814\r\nReady to process requests.\r\nrad_recv: Access-Request packet from host 172.16.0.1 port 1449, id=0, length=118\r\n        User-Name = \"steve\"\r\n        NAS-IP-Address = 127.0.0.1\r\n        Calling-Station-Id = \"02-00-00-00-00-01\"\r\n        Framed-MTU = 1400\r\n        NAS-Port-Type = Wireless-802.11\r\n        Connect-Info = \"CONNECT 11Mbps 802.11b\"\r\n        EAP-Message = 0x0200000a017374657665\r\n        Message-Authenticator = 0x91793fd6287c7a590026ec8a56f91676\r\n+- entering group authorize\r\n++[preprocess] returns ok\r\n++[chap] returns noop\r\n++[mschap] returns noop\r\n    rlm_realm: No '@' in User-Name = \"steve\", looking up realm NULL\r\n    rlm_realm: No such realm \"NULL\"\r\n++[suffix] returns noop\r\n  rlm_eap: EAP packet type response id 0 length 10\r\n  rlm_eap: No EAP Start, assuming it's an on-going EAP conversation\r\n++[eap] returns updated\r\n++[unix] returns notfound\r\n    users: Matched entry steve at line 78\r\n++[files] returns ok\r\n++[expiration] returns noop\r\n++[logintime] returns noop\r\nrlm_pap: Found existing Auth-Type, not changing it.\r\n++[pap] returns noop\r\n  rad_check_password:  Found Auth-Type EAP\r\nauth: type \"EAP\"\r\n+- entering group authenticate\r\n  rlm_eap: EAP Identity\r\n  rlm_eap: processing type md5\r\nrlm_eap_md5: Issuing Challenge\r\n++[eap] returns handled\r\nSending Access-Challenge of id 0 to 172.16.0.1 port 1449\r\n        Service-Type = Framed-User\r\n        Framed-Protocol = PPP\r\n        Framed-IP-Address = 172.16.3.33\r\n        Framed-IP-Netmask = 255.255.255.0\r\n        Framed-Routing = Broadcast-Listen\r\n        Framed-Filter-Id = \"std.ppp\"\r\n        Framed-MTU = 1500\r\n        Framed-Compression = Van-Jacobson-TCP-IP\r\n        EAP-Message = 0x010100160410fff5221d5a3f5d7fc5ec4f5b6d5be733\r\n        Message-Authenticator = 0x00000000000000000000000000000000\r\n        State = 0x69adaf1869acab9af45822a871805acf\r\nFinished request 0.\r\nGoing to the next request\r\nWaking up in 4.9 seconds.\r\nrad_recv: Access-Request packet from host 172.16.0.1 port 1449, id=1, length=132\r\n        User-Name = \"steve\"\r\n        NAS-IP-Address = 127.0.0.1\r\n        Calling-Station-Id = \"02-00-00-00-00-01\"\r\n        Framed-MTU = 1400\r\n        NAS-Port-Type = Wireless-802.11\r\n        Connect-Info = \"CONNECT 11Mbps 802.11b\"\r\n        EAP-Message = 0x020100060319\r\n        State = 0x69adaf1869acab9af45822a871805acf\r\n        Message-Authenticator = 0x3c18c00359cad04091c859546649a364\r\n+- entering group authorize\r\n++[preprocess] returns ok\r\n++[chap] returns noop\r\n++[mschap] returns noop\r\n    rlm_realm: No '@' in User-Name = \"steve\", looking up realm NULL\r\n    rlm_realm: No such realm \"NULL\"\r\n++[suffix] returns noop\r\n  rlm_eap: EAP packet type response id 1 length 6\r\n  rlm_eap: No EAP Start, assuming it's an on-going EAP conversation\r\n++[eap] returns updated\r\n++[unix] returns notfound\r\n    users: Matched entry steve at line 78\r\n++[files] returns ok\r\n++[expiration] returns noop\r\n++[logintime] returns noop\r\nrlm_pap: Found existing Auth-Type, not changing it.\r\n++[pap] returns noop\r\n  rad_check_password:  Found Auth-Type EAP\r\nauth: type \"EAP\"\r\n+- entering group authenticate\r\n  rlm_eap: Request found, released from the list\r\n  rlm_eap: EAP NAK\r\n rlm_eap: NAK asked for unsupported type 25\r\n rlm_eap: No common EAP types found.\r\n  rlm_eap: Failed in EAP select\r\n++[eap] returns invalid\r\nauth: Failed to validate the user.\r\n  Found Post-Auth-Type Reject\r\n+- entering group REJECT\r\n        expand: %{User-Name} -> steve\r\n attr_filter: Matched entry DEFAULT at line 11\r\n++[attr_filter.access_reject] returns updated\r\nSending Access-Reject of id 1 to 172.16.0.1 port 1449\r\n        EAP-Message = 0x04010004\r\n        Message-Authenticator = 0x00000000000000000000000000000000\r\nFinished request 1.\r\nGoing to the next request\r\nWaking up in 4.9 seconds.\r\nCleaning up request 0 ID 0 with timestamp +30\r\nCleaning up request 1 ID 1 with timestamp +30\r\nReady to process requests.\r\n\r\nClient: alex@alex-desktop:/usr/local/freeradius/etc/conf_for_eap_pol_testing$ \r\nsudo eapol_test -c \r\n/usr/local/freeradius/etc/conf_for_eap_pol_testing/eapol_test.conf.peap \r\n-a172.16.0.2 -p1812 -subuntu -r1\r\n[sudo] password for alex:\r\nReading configuration file \r\n'/usr/local/freeradius/etc/conf_for_eap_pol_testing/eapol_test.conf.\r\npeap'\r\nLine: 1 - start of a new network block\r\neap methods - hexdump(len=16): 00 00 00 00 19 00 00 00 00 00 00 00 00 \r\n00 00 00\r\neapol_flags=0 (0x0)\r\nkey_mgmt: 0x8\r\nidentity - hexdump_ascii(len=5):\r\n     73 74 65 76 65                                    \r\nsteve           \r\npassword - hexdump_ascii(len=7):\r\n     74 65 73 74 69 6e 67                              \r\ntesting         \r\nca_cert - hexdump_ascii(len=26):\r\n     2f 68 6f 6d 65 2f 61 6c 65 78 2f 6d 79 43 41 2f   \r\n/home/alex/myCA/\r\n     63 61 63 65 72 74 2e 70 65 6d                     cacert.\r\npem      \r\nphase2 - hexdump_ascii(len=13):\r\n     61 75 74 68 3d 4d 53 43 48 41 50 56 32            \r\nauth=MSCHAPV2   \r\nanonymous_identity - hexdump_ascii(len=5):\r\n     73 74 65 76 65                                    \r\nsteve           \r\nPriority group 0\r\n   id=0 ssid=''\r\nAuthentication server 172.16.0.2:1812\r\nEAPOL: SUPP_PAE entering state DISCONNECTED\r\nEAPOL: KEY_RX entering state NO_KEY_RECEIVE\r\nEAPOL: SUPP_BE entering state INITIALIZE\r\nEAP: EAP entering state DISABLED\r\nEAPOL: External notification - portValid=0\r\nEAPOL: External notification - portEnabled=1\r\nEAPOL: SUPP_PAE entering state CONNECTING\r\nEAPOL: SUPP_BE entering state IDLE\r\nEAP: EAP entering state INITIALIZE\r\nEAP: EAP entering state IDLE\r\nSending fake EAP-Request-Identity\r\nEAPOL: Received EAP-Packet frame\r\nEAPOL: SUPP_PAE entering state RESTART\r\nEAP: EAP entering state INITIALIZE\r\nEAP: EAP entering state IDLE\r\nEAPOL: SUPP_PAE entering state AUTHENTICATING\r\nEAPOL: SUPP_BE entering state REQUEST\r\nEAPOL: getSuppRsp\r\nEAP: EAP entering state RECEIVED\r\nEAP: Received EAP-Request id=0 method=1 vendor=0 vendorMethod=0\r\nEAP: EAP entering state IDENTITY\r\nCTRL-EVENT-EAP-STARTED EAP authentication started\r\nEAP: EAP-Request Identity data - hexdump_ascii(len=0):\r\nEAP: using anonymous identity - hexdump_ascii(len=5):\r\n     73 74 65 76 65                                    \r\nsteve           \r\nEAP: EAP entering state SEND_RESPONSE\r\nEAP: EAP entering state IDLE\r\nEAPOL: SUPP_BE entering state RESPONSE\r\nEAPOL: txSuppRsp\r\nWPA: eapol_test_eapol_send(type=0 len=10)\r\nTX EAP -> RADIUS - hexdump(len=10): 02 00 00 0a 01 73 74 65 76 65\r\nEncapsulating EAP message into a RADIUS packet\r\nLearned identity from EAP-Response-Identity - hexdump(len=5): 73 74 65 \r\n76 65\r\nSending RADIUS message to authentication server\r\nRADIUS message: code=1 (Access-Request) identifier=0 length=118\r\n   Attribute 1 (User-Name) length=7\r\n      Value: 'steve'\r\n   Attribute 4 (NAS-IP-Address) length=6\r\n      Value: 127.0.0.1\r\n   Attribute 31 (Calling-Station-Id) length=19\r\n      Value: '02-00-00-00-00-01'\r\n   Attribute 12 (Framed-MTU) length=6\r\n      Value: 1400\r\n   Attribute 61 (NAS-Port-Type) length=6\r\n      Value: 19\r\n   Attribute 77 (Connect-Info) length=24\r\n      Value: 'CONNECT 11Mbps 802.11b'\r\n   Attribute 79 (EAP-Message) length=12\r\n      Value: 02 00 00 0a 01 73 74 65 76 65\r\n   Attribute 80 (Message-Authenticator) length=18\r\n      Value: 91 79 3f d6 28 7c 7a 59 00 26 ec 8a 56 f9 16 76\r\nNext RADIUS client retransmit in 3 seconds\r\n \r\nEAPOL: SUPP_BE entering state RECEIVE\r\nReceived 131 bytes from RADIUS server\r\nReceived RADIUS message\r\nRADIUS message: code=11 (Access-Challenge) identifier=0 length=131\r\n   Attribute 6 (?Unknown?) length=6\r\n   Attribute 7 (?Unknown?) length=6\r\n   Attribute 8 (?Unknown?) length=6\r\n   Attribute 9 (?Unknown?) length=6\r\n   Attribute 10 (?Unknown?) length=6\r\n   Attribute 11 (?Unknown?) length=9\r\n   Attribute 12 (Framed-MTU) length=6\r\n      Value: 1500\r\n   Attribute 13 (?Unknown?) length=6\r\n   Attribute 79 (EAP-Message) length=24\r\n      Value: 01 01 00 16 04 10 ff f5 22 1d 5a 3f 5d 7f c5 ec 4f 5b 6d \r\n5b e7 33\r\n   Attribute 80 (Message-Authenticator) length=18\r\n      Value: 0f 00 eb ab ce 42 48 33 cb 1c cb d5 44 de 7f f4\r\n   Attribute 24 (State) length=18\r\n      Value: 69 ad af 18 69 ac ab 9a f4 58 22 a8 71 80 5a cf\r\nSTA 02:00:00:00:00:01: Received RADIUS packet matched with a pending \r\nrequest, round trip time 0.00 sec\r\nRADIUS packet matching with station\r\ndecapsulated EAP packet (code=1 id=1 len=22) from RADIUS server: EAP-\r\nRequest-MD5 (4)\r\nEAPOL: Received EAP-Packet frame\r\nEAPOL: SUPP_BE entering state REQUEST\r\nEAPOL: getSuppRsp\r\nEAP: EAP entering state RECEIVED\r\nEAP: Received EAP-Request id=1 method=4 vendor=0 vendorMethod=0\r\nEAP: EAP entering state GET_METHOD\r\nEAP: configuration does not allow: vendor 0 method 4\r\nEAP: vendor 0 method 4 not allowed\r\nEAP: Building EAP-Nak (requested type 4 vendor=0 method=0 not allowed)\r\nEAP: allowed methods - hexdump(len=1): 19\r\nEAP: EAP entering state SEND_RESPONSE\r\nEAP: EAP entering state IDLE\r\nEAPOL: SUPP_BE entering state RESPONSE\r\nEAPOL: txSuppRsp\r\nWPA: eapol_test_eapol_send(type=0 len=6)\r\nTX EAP -> RADIUS - hexdump(len=6): 02 01 00 06 03 19\r\nEncapsulating EAP message into a RADIUS packet\r\n  Copied RADIUS State Attribute\r\nSending RADIUS message to authentication server\r\nRADIUS message: code=1 (Access-Request) identifier=1 length=132\r\n   Attribute 1 (User-Name) length=7\r\n      Value: 'steve'\r\n   Attribute 4 (NAS-IP-Address) length=6\r\n      Value: 127.0.0.1\r\n   Attribute 31 (Calling-Station-Id) length=19\r\n      Value: '02-00-00-00-00-01'\r\n   Attribute 12 (Framed-MTU) length=6\r\n      Value: 1400\r\n   Attribute 61 (NAS-Port-Type) length=6\r\n      Value: 19\r\n   Attribute 77 (Connect-Info) length=24\r\n      Value: 'CONNECT 11Mbps 802.11b'\r\n   Attribute 79 (EAP-Message) length=8\r\n      Value: 02 01 00 06 03 19\r\n   Attribute 24 (State) length=18\r\n      Value: 69 ad af 18 69 ac ab 9a f4 58 22 a8 71 80 5a cf\r\n   Attribute 80 (Message-Authenticator) length=18\r\n      Value: 3c 18 c0 03 59 ca d0 40 91 c8 59 54 66 49 a3 64\r\nNext RADIUS client retransmit in 3 seconds\r\n \r\nEAPOL: SUPP_BE entering state RECEIVE\r\nReceived 44 bytes from RADIUS server\r\nReceived RADIUS message\r\nRADIUS message: code=3 (Access-Reject) identifier=1 length=44\r\n   Attribute 79 (EAP-Message) length=6\r\n      Value: 04 01 00 04\r\n   Attribute 80 (Message-Authenticator) length=18\r\n      Value: 9b 80 a5 d3 4a 83 07 61 be 85 18 df bf 96 7b 5f\r\nSTA 02:00:00:00:00:01: Received RADIUS packet matched with a pending \r\nrequest, round trip time 0.00 sec\r\nRADIUS packet matching with station\r\ndecapsulated EAP packet (code=4 id=1 len=4) from RADIUS server: EAP \r\nFailure\r\nEAPOL: Received EAP-Packet frame\r\nEAPOL: SUPP_BE entering state REQUEST\r\nEAPOL: getSuppRsp\r\nEAP: EAP entering state RECEIVED\r\nEAP: Received EAP-Failure\r\nEAP: EAP entering state FAILURE\r\nCTRL-EVENT-EAP-FAILURE EAP authentication failed\r\nEAPOL: SUPP_PAE entering state HELD\r\nEAPOL: SUPP_BE entering state RECEIVE\r\nEAPOL: SUPP_BE entering state FAIL\r\nEAPOL: SUPP_BE entering state IDLE\r\neapol_sm_cb: success=0\r\nMPPE keys OK: 0  mismatch: 2\r\nFAILURE\r\n\r\nIf I try to modify the IP address with 127.0.0.1 and the secret with the one of the localhost, I get a SUCCESS.\r\n\r\nI need to solve this problem before the first of September since I'm a student and my project is a stress testing of the FreeRadius Server. (I can't test it locally, since the same resources are used both for client and server). If I don't complete this task for the first of September, I lost all my work (relation above AAA protocols and relative testings).\r\n\r\nThanks a lot for any help\r\n\r\nAlessandro\r\n\r\n"
-
    name: 'Gong Cheng'
    mail: ''
    subject: "Hi Alessandro,\n   I am again"
    hostname: 67.119.14.3
    created: '1218323662'
    body: "Hi Alessandro,\r\n   I am again late for the responses. If you still have issues with this, I just posted a new script that can very easily generate certificates.\r\nfor basically, for TLS, you need both client cert/key and root CA cert on the eapol_test side, and both server cert/key and root CA cert on the RADIUS server side.\r\n\r\nFor TTLS/PEAP it is a little simpler, you won't need client cert/key on eapol_test side. (in theory,  you won't need root CA cert on radius server side either, but it is ok just to put it there anyway)"
-
    name: 'Gong Cheng'
    mail: ''
    subject: 'hi, i assume you already'
    hostname: 67.119.14.3
    created: '1218324450'
    body: "hi, i assume you already passed eap-md5 test remotely?\r\n\r\ncan you post your output from freeradius side by running it in debug mode\r\n\r\nradiusd -X\r\n\r\n-gong\r\n"
-
    name: alex_from_italy
    mail: ''
    subject: Hi
    hostname: 78.15.116.122
    created: '1219225966'
    body: "Thanks a lot for your answers. \r\n\r\nAnyway, just now I've seen that. I've resolved this problem. The one with TLS is instead still open :). Could you say me where is exactly the script for the generation of client and server cert\\key you've added? Would be very appreciated also the specification of the modifications to the configuration file of eapol_test (the fields specified in the other comment I leaved) and to the eap.conf (in Freeradius). \r\nI've tried also yesterday, but I've obtained no results.\r\n\r\nI need that for a thesys inside an exam at the University for a stress test to the FreeRadius server with heavy authentications.\r\n\r\nThank you very much.\r\n\r\nAlessandro.\r\n\r\nP.S.: Really no kind of problem for your delay."
-
    name: alex_from_italy
    mail: ''
    subject: Hi
    hostname: 78.15.116.122
    created: '1219302737'
    body: "Thanks a lot for your answers. \r\n\r\nAnyway, just now I've seen that. I've resolved this problem. The one with TLS is instead still open :). Could you say me where is exactly the script for the generation of client and server cert\\key you've added? Would be very appreciated also the specification of the modifications to the configuration file of eapol_test (the fields specified in the other comment I leaved) and to the eap.conf (in Freeradius). \r\nI've tried also yesterday, but I've obtained no results.\r\n\r\nI need that for a thesys inside an exam at the University for a stress test to the FreeRadius server with heavy authentications.\r\n\r\nThank you very much.\r\n\r\nAlessandro.\r\n\r\nP.S.: Really no kind of problem for your delay."
-
    name: 'Gong Cheng'
    mail: ''
    subject: Re
    hostname: 75.26.137.116
    created: '1219341574'
    body: "The new script I created is in this post of mine:\r\n\r\nhttp://www.freesoftwaremagazine.com/community_posts/generating_self_signed_test_certificates_using_one_single_shell_script\r\n\r\nAs for the TLS configurations, it is all in this post itself. I didn't need anything else.\r\n\r\nIf you still experience TLS problem, the log from radiusd side, especially the part with failure messages, would be very helpful in the diagnosis\r\n\r\n-gong"
-
    name: alex_from_italy
    mail: ''
    subject: Ok
    hostname: 78.15.132.196
    created: '1220183895'
    body: "Thanks a lot. \r\n\r\nIt works great.\r\n\r\nI've linked it in my thesys about secure configuration of Freeradius, in the section about the generation of Certificates.\r\n\r\n\r\nAlessandro"
-
    name: domel90
    mail: ''
    subject: 'please help me'
    hostname: 83.5.77.25
    created: '1321612892'
    body: "I have configured freeradius2 server on CeontOS OS and Cisco Catalyst 2950 switch - which requires from clients (Windows xp) 802.1x authentication.\r\n\r\n\r\nI have changed only /etc/raddb/clients.conf and /etc/raddb/users files.\r\n\r\nAll of tests which you described, I have performed and it's working well.\r\n\r\nWhen Windows XP client is using  MD5-challenge authentication, it's working properly and client is abble to connect to my network.\r\n\r\nBut i would like to use PEAP (EAP-MSCHAPv2) authentication.\r\n\r\nJ have configured clients like this:\r\n\r\nhttp://212.191.88.2/~dwolnicki/kamiz/1.png\r\nhttp://212.191.88.2/~dwolnicki/kamiz/2.png\r\n\r\nBut client can not be authenticated by the freeradius server.\r\n\r\nI got this screen.\r\n\r\nFreeRADIUS Version 2.1.7, for host i686-redhat-linux-gnu, built on Mar 31 2010 at 00:25:31\r\nCopyright (C) 1999-2009 The FreeRADIUS server project and contributors. \r\nThere is NO warranty; not even for MERCHANTABILITY or FITNESS FOR A \r\nPARTICULAR PURPOSE. \r\nYou may redistribute copies of FreeRADIUS under the terms of the \r\nGNU General Public License v2. \r\nStarting - reading configuration files ...\r\nincluding configuration file /etc/raddb/radiusd.conf\r\nincluding configuration file /etc/raddb/proxy.conf\r\nincluding configuration file /etc/raddb/clients.conf\r\nincluding files in directory /etc/raddb/modules/\r\nincluding configuration file /etc/raddb/modules/detail\r\nincluding configuration file /etc/raddb/modules/realm\r\nincluding configuration file /etc/raddb/modules/etc_group\r\nincluding configuration file /etc/raddb/modules/exec\r\nincluding configuration file /etc/raddb/modules/sql_log\r\nincluding configuration file /etc/raddb/modules/preprocess\r\nincluding configuration file /etc/raddb/modules/expiration\r\nincluding configuration file /etc/raddb/modules/passwd\r\nincluding configuration file /etc/raddb/modules/sqlcounter_expire_on_login\r\nincluding configuration file /etc/raddb/modules/sradutmp\r\nincluding configuration file /etc/raddb/modules/always\r\nincluding configuration file /etc/raddb/modules/detail.example.com\r\nincluding configuration file /etc/raddb/modules/expr\r\nincluding configuration file /etc/raddb/modules/mschap\r\nincluding configuration file /etc/raddb/modules/otp\r\nincluding configuration file /etc/raddb/modules/counter\r\nincluding configuration file /etc/raddb/modules/policy\r\nincluding configuration file /etc/raddb/modules/echo\r\nincluding configuration file /etc/raddb/modules/perl\r\nincluding configuration file /etc/raddb/modules/pam\r\nincluding configuration file /etc/raddb/modules/mac2ip\r\nincluding configuration file /etc/raddb/modules/checkval\r\nincluding configuration file /etc/raddb/modules/smbpasswd\r\nincluding configuration file /etc/raddb/modules/ippool\r\nincluding configuration file /etc/raddb/modules/files\r\nincluding configuration file /etc/raddb/modules/acct_unique\r\nincluding configuration file /etc/raddb/modules/smsotp\r\nincluding configuration file /etc/raddb/modules/radutmp\r\nincluding configuration file /etc/raddb/modules/attr_filter\r\nincluding configuration file /etc/raddb/modules/chap\r\nincluding configuration file /etc/raddb/modules/inner-eap\r\nincluding configuration file /etc/raddb/modules/pap\r\nincluding configuration file /etc/raddb/modules/logintime\r\nincluding configuration file /etc/raddb/modules/attr_rewrite\r\nincluding configuration file /etc/raddb/modules/detail.log\r\nincluding configuration file /etc/raddb/modules/linelog\r\nincluding configuration file /etc/raddb/modules/digest\r\nincluding configuration file /etc/raddb/modules/wimax\r\nincluding configuration file /etc/raddb/modules/mac2vlan\r\nincluding configuration file /etc/raddb/modules/cui\r\nincluding configuration file /etc/raddb/modules/unix\r\nincluding configuration file /etc/raddb/eap.conf\r\nincluding configuration file /etc/raddb/policy.conf\r\nincluding files in directory /etc/raddb/sites-enabled/\r\nincluding configuration file /etc/raddb/sites-enabled/default\r\nincluding configuration file /etc/raddb/sites-enabled/inner-tunnel\r\nincluding configuration file /etc/raddb/sites-enabled/control-socket\r\ngroup = radiusd\r\nuser = radiusd\r\nincluding dictionary file /etc/raddb/dictionary\r\nmain {\r\n        prefix = \"/usr\"\r\n        localstatedir = \"/var\"\r\n        logdir = \"/var/log/radius\"\r\n        libdir = \"/usr/lib/freeradius\"\r\n        radacctdir = \"/var/log/radius/radacct\"\r\n        hostname_lookups = no\r\n        max_request_time = 30\r\n        cleanup_delay = 5\r\n        max_requests = 1024\r\n        allow_core_dumps = no\r\n        pidfile = \"/var/run/radiusd/radiusd.pid\"\r\n        checkrad = \"/usr/sbin/checkrad\"\r\n        debug_level = 0\r\n        proxy_requests = yes\r\n log {\r\n        stripped_names = no\r\n        auth = no\r\n        auth_badpass = no\r\n        auth_goodpass = no\r\n }\r\n security {\r\n        max_attributes = 200\r\n        reject_delay = 1\r\n        status_server = yes\r\n }\r\n}\r\n\r\nradiusd: #### Loading Realms and Home Servers ####\r\n proxy server {\r\n        retry_delay = 5\r\n        retry_count = 3\r\n        default_fallback = no\r\n        dead_time = 120\r\n        wake_all_if_all_dead = no\r\n }\r\n home_server localhost {\r\n        ipaddr = 127.0.0.1\r\n        port = 1812\r\n        type = \"auth\"\r\n        secret = \"testing123\"\r\n        response_window = 20\r\n        max_outstanding = 65536\r\n        require_message_authenticator = no\r\n        zombie_period = 40\r\n        status_check = \"status-server\"\r\n        ping_interval = 30\r\n        check_interval = 30\r\n        num_answers_to_alive = 3\r\n        num_pings_to_alive = 3\r\n        revive_interval = 120\r\n        status_check_timeout = 4\r\n        irt = 2\r\n        mrt = 16\r\n        mrc = 5\r\n        mrd = 30\r\n }\r\n home_server_pool my_auth_failover {\r\n        type = fail-over\r\n        home_server = localhost\r\n }\r\n realm example.com {\r\n        auth_pool = my_auth_failover\r\n }\r\n realm LOCAL {\r\n }\r\nradiusd: #### Loading Clients ####\r\n client localhost {\r\n        ipaddr = 127.0.0.1\r\n        require_message_authenticator = no\r\n        secret = \"testing123\"\r\n        nastype = \"other\"\r\n:\r\n }\r\n client 192.168.0.0/16 {\r\n        require_message_authenticator = no\r\n        secret = \"remote\"\r\n        shortname = \"private-network-1\"\r\n }\r\nradiusd: #### Instantiating modules ####\r\n instantiate {\r\n Module: Linked to module rlm_exec\r\n Module: Instantiating exec\r\n  exec {\r\n        wait = no\r\n        input_pairs = \"request\"\r\n        shell_escape = yes\r\n  }\r\n Module: Linked to module rlm_expr\r\n Module: Instantiating expr\r\n Module: Linked to module rlm_expiration\r\n Module: Instantiating expiration\r\n  expiration {\r\n        reply-message = \"Password Has Expired  \"\r\n  }\r\n Module: Linked to module rlm_logintime\r\n Module: Instantiating logintime\r\n  logintime {\r\n        reply-message = \"You are calling outside your allowed timespan  \"\r\n        minimum-timeout = 60\r\n  }\r\n }\r\nradiusd: #### Loading Virtual Servers ####\r\nserver inner-tunnel {\r\n modules {\r\n Module: Checking authenticate {...} for more modules to load\r\n Module: Linked to module rlm_pap\r\n Module: Instantiating pap\r\n  pap {\r\n        encryption_scheme = \"auto\"\r\n        auto_header = no\r\n  }\r\n Module: Linked to module rlm_chap\r\n Module: Instantiating chap\r\n Module: Linked to module rlm_mschap\r\n Module: Instantiating mschap\r\n  mschap {\r\n\r\n        use_mppe = yes\r\n        require_encryption = no\r\n        require_strong = no\r\n        with_ntdomain_hack = no\r\n  }\r\n Module: Linked to module rlm_unix\r\n Module: Instantiating unix\r\n  unix {\r\n        radwtmp = \"/var/log/radius/radwtmp\"\r\n  }\r\n Module: Linked to module rlm_eap\r\n Module: Instantiating eap\r\n  eap {\r\n        default_eap_type = \"md5\"\r\n        timer_expire = 60\r\n        ignore_unknown_eap_types = no\r\n        cisco_accounting_username_bug = no\r\n        max_sessions = 2048\r\n  }\r\n Module: Linked to sub-module rlm_eap_md5\r\n Module: Instantiating eap-md5\r\n Module: Linked to sub-module rlm_eap_leap\r\n Module: Instantiating eap-leap\r\n Module: Linked to sub-module rlm_eap_gtc\r\n Module: Instantiating eap-gtc\r\n   gtc {\r\n        challenge = \"Password: \"\r\n        auth_type = \"PAP\"\r\n   }\r\n Module: Linked to sub-module rlm_eap_tls\r\n Module: Instantiating eap-tls\r\n   tls {\r\n        rsa_key_exchange = no\r\n        dh_key_exchange = yes\r\n        rsa_key_length = 512\r\n        dh_key_length = 512\r\n        verify_depth = 0\r\n        pem_file_type = yes\r\n        private_key_file = \"/etc/raddb/certs/server.pem\"\r\n        certificate_file = \"/etc/raddb/certs/server.pem\"\r\n        CA_file = \"/etc/raddb/certs/ca.pem\"\r\n        private_key_password = \"whatever\"\r\n        dh_file = \"/etc/raddb/certs/dh\"\r\n        random_file = \"/etc/raddb/certs/random\"\r\n        fragment_size = 1024       include_length = yes\r\n        check_crl = no\r\n        cipher_list = \"DEFAULT\"\r\n        make_cert_command = \"/etc/raddb/certs/bootstrap\"\r\n    cache {\r\n        enable = no\r\n        lifetime = 24\r\n        max_entries = 255\r\n    }\r\n   }\r\n Module: Linked to sub-module rlm_eap_ttls\r\n Module: Instantiating eap-ttls\r\n   ttls {\r\n        default_eap_type = \"md5\"\r\n        copy_request_to_tunnel = no\r\n        use_tunneled_reply = no\r\n        virtual_server = \"inner-tunnel\"\r\n        include_length = yes\r\n   }\r\n Module: Linked to sub-module rlm_eap_peap\r\n Module: Instantiating eap-peap\r\n   peap {\r\n        default_eap_type = \"mschapv2\"\r\n        copy_request_to_tunnel = no\r\n        use_tunneled_reply = no\r\n        proxy_tunneled_request_as_eap = yes\r\n        virtual_server = \"inner-tunnel\"\r\n   }\r\n Module: Linked to sub-module rlm_eap_mschapv2\r\n Module: Instantiating eap-mschapv2\r\n   mschapv2 {\r\n        with_ntdomain_hack = no\r\n   }\r\n Module: Checking authorize {...} for more modules to load\r\n Module: Linked to module rlm_realm\r\n Module: Instantiating suffix\r\n  realm suffix {\r\n        format = \"suffix\"\r\n        delimiter = \"@\"\r\n        ignore_default = no\r\n        ignore_null = no\r\n  }\r\n Module: Linked to module rlm_files\r\n Module: Instantiating files\r\nfiles {\r\n        usersfile = \"/etc/raddb/users\"\r\n        acctusersfile = \"/etc/raddb/acct_users\"\r\n        preproxy_usersfile = \"/etc/raddb/preproxy_users\"\r\n        compat = \"no\"\r\n  }\r\n Module: Checking session {...} for more modules to load\r\n Module: Linked to module rlm_radutmp\r\n Module: Instantiating radutmp\r\n  radutmp {\r\n        filename = \"/var/log/radius/radutmp\"\r\n        username = \"%{User-Name}\"\r\n        case_sensitive = yes\r\n        check_with_nas = yes\r\n        perm = 384\r\n        callerid = yes\r\n  }\r\n Module: Checking post-proxy {...} for more modules to load\r\n Module: Checking post-auth {...} for more modules to load\r\n Module: Linked to module rlm_attr_filter\r\n Module: Instantiating attr_filter.access_reject\r\n  attr_filter attr_filter.access_reject {\r\n        attrsfile = \"/etc/raddb/attrs.access_reject\"\r\n        key = \"%{User-Name}\"\r\n  }\r\n } # modules\r\n} # server\r\nserver {\r\n modules {\r\n Module: Checking authenticate {...} for more modules to load\r\n Module: Checking authorize {...} for more modules to load\r\n Module: Linked to module rlm_preprocess\r\n Module: Instantiating preprocess\r\n  preprocess {\r\n        huntgroups = \"/etc/raddb/huntgroups\"\r\n        hints = \"/etc/raddb/hints\"\r\n        with_ascend_hack = no\r\n        ascend_channels_per_line = 23\r\n        with_ntdomain_hack = no\r\n        with_specialix_jetstream_hack = no\r\n        with_cisco_vsa_hack = no\r\n        with_alvarion_vsa_hack = no\r\n  }\r\n Module: Checking preacct {...} for more modules to load\r\n Module: Linked to module rlm_acct_unique\r\n Module: Instantiating acct_unique\r\n  acct_unique {\r\n        key = \"User-Name, Acct-Session-Id, NAS-IP-Address, Client-IP-Address, NAS-Port\"\r\n  }\r\n Module: Checking accounting {...} for more modules to load\r\n Module: Linked to module rlm_detail\r\n Module: Instantiating detail\r\n  detail {\r\n        detailfile = \"/var/log/radius/radacct/%{Client-IP-Address}/detail-%Y%m%d\"\r\n        header = \"%t\"\r\n        detailperm = 384\r\n        dirperm = 493\r\n        locking = no\r\n        log_packet_header = no\r\n  }\r\n Module: Instantiating attr_filter.accounting_response\r\n  attr_filter attr_filter.accounting_response {\r\n        attrsfile = \"/etc/raddb/attrs.accounting_response\"\r\n        key = \"%{User-Name}\"\r\n  }\r\n Module: Checking session {...} for more modules to load\r\n Module: Checking post-proxy {...} for more modules to load\r\n Module: Checking post-auth {...} for more modules to load\r\n } # modules\r\n} # server\r\nradiusd: #### Opening IP addresses and Ports ####\r\nlisten {\r\n        type = \"auth\"\r\n        ipaddr = *\r\n        port = 0\r\n}\r\nlisten {\r\n        type = \"acct\"\r\n        ipaddr = *\r\n        port = 0\r\n}\r\nlisten {\r\n        type = \"control\"\r\n listen {\r\n        socket = \"/var/run/radiusd/radiusd.sock\"\r\n }\r\n}\r\nListening on authentication address * port 1812\r\nListening on accounting address * port 1813\r\nListening on command file /var/run/radiusd/radiusd.sock\r\nListening on proxy address * port 1814\r\nReady to process requests.\r\n\r\n\r\nrad_recv: Access-Request packet from host 192.168.0.250 port 1812, id=230, length=100\r\n        NAS-IP-Address = 192.168.0.250\r\n        NAS-Port = 50012\r\n        NAS-Port-Type = Ethernet\r\n        User-Name = \"domel\"\r\n        Calling-Station-Id = \"00-1C-25-1A-01-FB\"\r\n        Service-Type = Framed-User\r\n        EAP-Message = 0x0201000a01646f6d656c\r\n        Message-Authenticator = 0x84ed781a5a3a6725cd4c26c882893200\r\n+- entering group authorize {...}\r\n++[preprocess] returns ok\r\n++[chap] returns noop\r\n++[mschap] returns noop\r\n[suffix] No '@' in User-Name = \"domel\", looking up realm NULL\r\n[suffix] No such realm \"NULL\"\r\n++[suffix] returns noop\r\n[eap] EAP packet type response id 1 length 10\r\n[eap] No EAP Start, assuming it's an on-going EAP conversation\r\n++[eap] returns updated\r\n++[unix] returns notfound\r\n[files] users: Matched entry domel at line 207\r\n++[files] returns ok\r\n++[expiration] returns noop\r\n++[logintime] returns noop\r\n[pap] Found existing Auth-Type, not changing it.\r\n++[pap] returns noop\r\nFound Auth-Type = EAP\r\n+- entering group authenticate {...}\r\n[eap] EAP Identity\r\n[eap] processing type md5\r\nrlm_eap_md5: Issuing Challenge\r\n++[eap] returns handled\r\nSending Access-Challenge of id 230 to 192.168.0.250 port 1812\r\n        EAP-Message = 0x010200160410b9bd67a1ac50036116f1c32d8dda0436\r\n        Message-Authenticator = 0x00000000000000000000000000000000\r\n        State = 0x5e8a17c65e8813bb06a5f383d0675698\r\nFinished request 0.\r\nGoing to the next request\r\nWaking up in 4.9 seconds.\r\n\r\n\r\n\r\n\r\nrad_recv: Access-Request packet from host 192.168.0.250 port 1812, id=230, length=100\r\n        NAS-IP-Address = 192.168.0.250\r\n        NAS-Port = 50012\r\n        NAS-Port-Type = Ethernet\r\n        User-Name = \"domel\"\r\n        Calling-Station-Id = \"00-1C-25-1A-01-FB\"\r\n        Service-Type = Framed-User\r\n        EAP-Message = 0x0201000a01646f6d656c\r\n        Message-Authenticator = 0x84ed781a5a3a6725cd4c26c882893200\r\n+- entering group authorize {...}\r\n++[preprocess] returns ok\r\n++[chap] returns noop\r\n++[mschap] returns noop\r\n[suffix] No '@' in User-Name = \"domel\", looking up realm NULL\r\n[suffix] No such realm \"NULL\"\r\n++[suffix] returns noop\r\n[eap] EAP packet type response id 1 length 10\r\n[eap] No EAP Start, assuming it's an on-going EAP conversation\r\n++[eap] returns updated\r\n++[unix] returns notfound\r\n[files] users: Matched entry domel at line 207\r\n++[files] returns ok\r\n++[expiration] returns noop\r\n++[logintime] returns noop\r\n[pap] Found existing Auth-Type, not changing it.\r\n++[pap] returns noop\r\nFound Auth-Type = EAP\r\n+- entering group authenticate {...}\r\n[eap] EAP Identity\r\n[eap] processing type md5\r\nrlm_eap_md5: Issuing Challenge\r\n++[eap] returns handled\r\nSending Access-Challenge of id 230 to 192.168.0.250 port 1812\r\n        EAP-Message = 0x010200160410b9bd67a1ac50036116f1c32d8dda0436\r\n        Message-Authenticator = 0x00000000000000000000000000000000\r\n        State = 0x5e8a17c65e8813bb06a5f383d0675698\r\nFinished request 0.\r\nGoing to the next request\r\nWaking up in 4.9 seconds.\r\nrad_recv: Access-Request packet from host 192.168.0.250 port 1812, id=231, length=114\r\n        NAS-IP-Address = 192.168.0.250\r\n        NAS-Port = 50012\r\n        NAS-Port-Type = Ethernet\r\n        User-Name = \"domel\"\r\n        Calling-Station-Id = \"00-1C-25-1A-01-FB\"\r\n        Service-Type = Framed-User\r\n        State = 0x5e8a17c65e8813bb06a5f383d0675698\r\n        EAP-Message = 0x020200060319\r\n        Message-Authenticator = 0xc722fae4c1fd0bb5921d749d3bbbed24\r\n+- entering group authorize {...}\r\n++[preprocess] returns ok\r\n++[chap] returns noop\r\n++[mschap] returns noop\r\n[suffix] No '@' in User-Name = \"domel\", looking up realm NULL\r\n[suffix] No such realm \"NULL\"\r\n++[suffix] returns noop\r\n[eap] EAP packet type response id 2 length 6\r\n[eap] No EAP Start, assuming it's an on-going EAP conversation\r\n++[eap] returns updated\r\n++[unix] returns notfound\r\n[files] users: Matched entry domel at line 207\r\n++[files] returns ok\r\n++[expiration] returns noop\r\n++[logintime] returns noop\r\n[pap] Found existing Auth-Type, not changing it.\r\n++[pap] returns noop\r\nFound Auth-Type = EAP\r\n+- entering group authenticate {...}\r\n[eap] Request found, released from the list\r\n[eap] EAP NAK\r\n[eap] EAP-NAK asked for EAP-Type/peap\r\n[eap] processing type tls\r\n[tls] Initiate\r\n[tls] Start returned 1\r\n++[eap] returns handled\r\nSending Access-Challenge of id 231 to 192.168.0.250 port 1812\r\n        EAP-Message = 0x010300061920\r\n        Message-Authenticator = 0x00000000000000000000000000000000\r\n        State = 0x5e8a17c65f890ebb06a5f383d0675698\r\nFinished request 1.\r\nGoing to the next request\r\nWaking up in 4.9 seconds.\r\nrad_recv: Access-Request packet from host 192.168.0.250 port 1812, id=232, length=188\r\n      NAS-IP-Address = 192.168.0.250\r\n        NAS-Port = 50012\r\n        NAS-Port-Type = Ethernet\r\n        User-Name = \"domel\"\r\n        Calling-Station-Id = \"00-1C-25-1A-01-FB\"\r\n        Service-Type = Framed-User\r\n        State = 0x5e8a17c65f890ebb06a5f383d0675698\r\n        EAP-Message = 0x0203005019800000004616030100410100003d03014ec6358c27ae5accd26d068edf67f17505b8a4e13a29a36b11d087cc8f8b0c7500001600040005000a00090064006200030006001300120\r\n0630100\r\n        Message-Authenticator = 0xea8b7896b47fd9d5e0d6dd9f79806d87\r\n+- entering group authorize {...}\r\n++[preprocess] returns ok\r\n++[chap] returns noop\r\n++[mschap] returns noop\r\n[suffix] No '@' in User-Name = \"domel\", looking up realm NULL\r\n[suffix] No such realm \"NULL\"\r\n++[suffix] returns noop\r\n[eap] EAP packet type response id 3 length 80\r\n[eap] Continuing tunnel setup.\r\n++[eap] returns ok\r\nFound Auth-Type = EAP\r\n+- entering group authenticate {...}\r\n[eap] Request found, released from the list\r\n[eap] EAP/peap\r\n[eap] processing type peap\r\n[peap] processing EAP-TLS\r\n  TLS Length 70\r\n[peap] Length Included\r\n[peap] eaptls_verify returned 11 \r\n[peap]     (other): before/accept initialization \r\n[peap]     TLS_accept: before/accept initialization \r\n[peap] <<< TLS 1.0 Handshake [length 0041], ClientHello  \r\n[peap]     TLS_accept: SSLv3 read client hello A \r\n[peap] >>> TLS 1.0 Handshake [length 002a], ServerHello  \r\n[peap]     TLS_accept: SSLv3 write server hello A \r\n[peap] >>> TLS 1.0 Handshake [length 085e], Certificate  \r\n[peap]     TLS_accept: SSLv3 write certificate A \r\n[peap] >>> TLS 1.0 Handshake [length 0004], ServerHelloDone  \r\n[peap]     TLS_accept: SSLv3 write server done A \r\n[peap]     TLS_accept: SSLv3 flush data \r\n[peap]     TLS_accept: Need to read more data: SSLv3 read client certificate A\r\nIn SSL Handshake Phase \r\nIn SSL Accept mode  \r\n[peap] eaptls_process returned 13 \r\n[peap] processing EAP-TLS\r\n  TLS Length 70\r\n[peap] Length Included\r\n[peap] eaptls_verify returned 11 \r\n[peap]     (other): before/accept initialization \r\n[peap]     TLS_accept: before/accept initialization \r\n[peap] <<< TLS 1.0 Handshake [length 0041], ClientHello  \r\n[peap]     TLS_accept: SSLv3 read client hello A \r\n[peap] >>> TLS 1.0 Handshake [length 002a], ServerHello  \r\n[peap]     TLS_accept: SSLv3 write server hello A \r\n[peap] >>> TLS 1.0 Handshake [length 085e], Certificate  \r\n[peap]     TLS_accept: SSLv3 write certificate A \r\n[peap] >>> TLS 1.0 Handshake [length 0004], ServerHelloDone  \r\n[peap]     TLS_accept: SSLv3 write server done A \r\n[peap]     TLS_accept: SSLv3 flush data \r\n[peap]     TLS_accept: Need to read more data: SSLv3 read client certificate A\r\nIn SSL Handshake Phase \r\nIn SSL Accept mode  \r\n[peap] eaptls_process returned 13 \r\n[peap] EAPTLS_HANDLED\r\n++[eap] returns handled\r\nSending Access-Challenge of id 232 to 192.168.0.250 port 1812\r\n        EAP-Message = 0x0104040019c00000089b160301002a0200002603014ec635845f98121597d9fd47462332f24c1093e906a531065c08786f634fb6d900000400160301085e0b00085a0008570003a6308203a23\r\n082028aa003020102020101300d06092a864886f70d0101040500308193310b3009060355040613024652310f300d060355040813065261646975733112301006035504071309536f6d65776865726531153013060355040a\r\n130c4578616d706c6520496e632e3120301e06092a864886f70d010901161161646d696e406578616d706c652e636f6d312630240603550403131d4578616d706c6520436572746966696361746520417574686f72697479\r\n        EAP-Message = 0x301e170d3131313131383038313435315a170d3132313131373038313435315a307c310b3009060355040613024652310f300d0603550408130652616469757331153013060355040a130c457\r\n8616d706c6520496e632e312330210603550403131a4578616d706c65205365727665722043657274696669636174653120301e06092a864886f70d010901161161646d696e406578616d706c652e636f6d30820122300d06\r\n092a864886f70d01010105000382010f003082010a0282010100a1fbf2f2eecc7ef17b2728a75ac2041a798e54bdc8f14533a7407ba71355e3efad3f80f47a2abea364573adc0a48df1a4bffe280cf1c5e0de78f64bcfbdb\r\n        EAP-Message = 0x5a0f2c68878d296c001a259dcf60c1c95cfa9b3df6c38c51a2bf7d6c286614d9309f44b08b8661706cc89783f2e49c5b48d3fb0f729cae7fb6a60325f8abdae67b0954ce2a31dc6eafa75ac47\r\n1f06181b3d48a43a1e1b31510c058ddb1c6069c07e33b4e3fb15bccf3a593ae55983594b7173a0728965d3fe9003971d0aac93ac9bdb30aa90430648687284ed4c2c3d7955bae1adc6e4d8415d7d0ffd1b7ee948f0b10bfeb\r\n28d04a0418df249e403446356a0b82226000b5d37b7365ca29d88eaa8d0203010001a317301530130603551d25040c300a06082b06010505070301300d06092a864886f70d010104050003820101004c0e0b2043fc5a0c0a\r\n        EAP-Message = 0x3c3294216a4601bd8454fbc1ad0e272cedc1e8ae9e7294be24d13c2b424fe1d903e6e1a1446ba7b270378d6e3cb0d1a471397291d4ead59d4c1c7a4379aabe817d63f085d64bbb9e624913895\r\n5bd8d3429e23d0d41956db8abda56cb7a14502c8648b2efb91eb17d4efd129e4292965d0f652b1766c668b1538b945e2f4aefa3906452ebbd883ca658a307df52ad359c84d7ce0a2c266d89bb51e65b5a3f848f8889b2ed04\r\n9b584f1cbecbd3ef87a7dc229ea1a8f5a2b55711971833aef31c9a53254658ee10032c9dda5ba20f98fe87875c48683604199606afe70103e6ccf473d72a179ba43d20ba68924d5ca3fc9998be713ee1885d0004ab308204\r\n        EAP-Message = 0xa73082038fa0030201020209\r\n        Message-Authenticator = 0x00000000000000000000000000000000\r\n        State = 0x5e8a17c65c8e0ebb06a5f383d0675698\r\nFinished request 2.\r\nGoing to the next request\r\nWaking up in 4.9 seconds.\r\nCleaning up request 0 ID 230 with timestamp +12\r\nCleaning up request 1 ID 231 with timestamp +12\r\nCleaning up request 2 ID 232 with timestamp +12\r\nReady to process requests.\r\n\r\n\r\n\r\nSo please tell me what is wrong??\r\nThank you very much.\r\n"
